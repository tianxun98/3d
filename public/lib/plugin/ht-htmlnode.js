!function(m){"use strict";var V="ht",x=m[V],L=function(){return document},z=function(){return L().body},l=function(k,M,s){k.style.setProperty(M,s,null)},R=function(Z){return L().createElement(Z)},W=function(){return R("div")},P=function(){var M=R("canvas");return M},f=function(x,D){l(x,"-webkit-transform",D),l(x,"-ms-transform",D),l(x,"transform",D)},I=function(L,Y){l(L,"-webkit-transform-origin",Y),l(L,"-ms-transform-origin",Y),l(L,"transform-origin",Y)},Q=function(P,N){P.appendChild(N)},r=function(q,p){q.removeChild(p)},D=m.parseInt,U=x.Default,N=U.eventListenerOptionsFalse,p=(U.eventListenerOptionsTrue,function(b,H,g,K){b.addEventListener(H,g,K?N:N)}),o=U.getInternal(),w=Math.PI,d="white-space",a="visibility",j="left",S="top",X="width",i="height",E="position",Z="display",K="z-index",Y="px",c="0 0",M="absolute",n="visible",$="hidden",g="none",q="block",A="nowrap",F="rgba(0, 0, 0, 0.005)";U.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var J=x.graph.GraphView.prototype,T=J._42;J.adjustHtmlNodeIndex=!0,J._42=function(M,F){if(T.call(this,M,F),this.adjustHtmlNodeIndex)for(var J=this.getDataModel()._datas._as,r=J.length,W=1,O=0;r>O;O++){var w=J[O];if(w instanceof B){var X=this.getDataUI(w);l(X.$2f,K,W+""),l(X.$3f,K,W+1+""),W+=2}}};var H=x.HtmlNodeUI=function(R,G){var F=this;H.superClass.constructor.call(F,R,G);var h=F.$2f=W(),f=F.$3f=P();l(h,E,M),l(h,a,$),l(h,d,A),f.draggable=!1,l(f,E,M),l(f,Z,g),I(f,c),p(h,"change",function(Z){var d=Z.target,i=d.bind||d.getAttribute("bind"),j=d.type&&"checkbox"===d.type?d.checked:d.value,$=G.getContext();i&&$&&($[i]=j,F.$4f=JSON.stringify($))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(D){p(h,D,this.$9f.bind(this))},F)};U.def(H,o.ui().NodeUI,{_visible:!0,$11f:function(){var y=this,D=y.$3f,V=y._data,d=V.getDraggerImageWidth(),b=V.getDraggerImageHeight(),h=V.getDraggerImage(),G=o.initContext(D);G.beginPath(),o.setCanvas(D,d,b),o.translateAndScale(G,0,0,1),G.clearRect(0,0,d,b),U.drawImage(G,U.getImage(h),0,0,d,b),G.restore()},_80o:function(U){H.superClass._80o.call(this,U);var o=this,h=o._data,r=h._padding,A=2*r,B=o.$2f,N=o.$3f,J=o.gv,d=J.getZoom(),z=J.getTranslateX(),m=J.getTranslateY(),t=J.getView(),s=o._83o,P=h._width,e=h._height,V=s.position,C=s.rotation,_=(P-A)/h.$5f*d,u=(e-A)/h.$6f*d,k=o._html,v=h._html,G=h.getHtmlType();if("html"===G){var I=h.getContext()||{},x=o.$4f,R=h.$10f,b=JSON.stringify(I);k&&x&&k===v&&x===b||(o.$4f=b,o._html=v,B.innerHTML=R?R(I):v)}else if(null!=G){var p=h.getHtml();"ht"===G&&(p=p.getView()),k&&k===p&&B.contains(k)||(o._html=p,B.innerHTML="",Q(B,p))}if(!B.parentNode){var O=J.$1f;if(!O){var y=W();l(y,E,M),l(y,K,"0"),O=J.$1f=y;var T=J._canvas.nextSibling;T?t.insertBefore(y,T):Q(t,y)}Q(O,B),Q(O,N),h.onContentInitialized&&h.onContentInitialized(B)}if(h._scalable){var L=h.$5f,c=h.$6f;f(B,"rotate("+180*(C/w)+"deg) scale("+_+","+u+")"),l(B,X,""),l(B,i,""),l(B,j,(V.x-L/d/2)*d+z+Y),l(B,S,(V.y-c/d/2)*d+m+Y)}else{var cg=D(B.style.width),uj=D(B.style.height),fg=D((P-A)*d),fq=D((e-A)*d),gh="100%",Fq=B.children[0];l(Fq,X,gh),l(Fq,i,gh),(cg!==fg||uj!==fq)&&(l(B,X,fg+Y),l(B,i,fq+Y),"ht"===G&&v.invalidate()),f(B,"rotate("+180*(C/w)+"deg)"),l(B,j,(V.x-fg/d/2)*d+z+Y),l(B,S,(V.y-fq/d/2)*d+m+Y)}var pg=o.dragRect;J.isMovable(h)&&J.isSelected(h)&&pg?(U.save(),U.fillStyle=F,U.fillRect(pg.x,pg.y,pg.width,pg.height),U.restore(),l(N,j,pg.x*d+z+Y),l(N,S,pg.y*d+m+Y),f(N,"scale("+d+","+d+")"),l(N,Z,q),o.$11f()):l(N,Z,g),l(B,a,this._visible?n:$)},dispose:function(){var g=this.gv.$1f;this.$2f.parentNode===g&&g.removeChild(this.$2f),this.$3f.parentNode===g&&g.removeChild(this.$3f)},_84o:function(B){this._visible=B,l(this.$2f,a,B?n:$),l(this.$3f,Z,B?q:g)},_3O:function(){var R=this,O=R.gv,o=R._data;H.superClass._3O.call(R);var J=o.getRect();O.isEditable(o)&&(R.dragRect={x:J.x+J.width+o._padding,y:J.y+10,width:o.getDraggerImageWidth(),height:o.getDraggerImageHeight()},R._68o(R.dragRect))},rectIntersects:function(l){var h=this._79o();return x.Default.intersection(h,l)?!0:void 0},$9f:function(R){var K=this.gv,q=this._data;K.sm().contains(q)&&R.stopPropagation()}});var B=x.HtmlNode=function(){B.superClass.constructor.call(this)};x.Default.def(B,x.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:x.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(W){var f=this,D=f._html;f._html=W,"html"===f.getHtmlType()&&"Handlebars"in m&&(f.$10f=Handlebars.compile(W)),f.$13f(),f.fp("html",D,W)},setContext:function(f){var p=this,A=p._context;p._context=f,p.fp("context",A,f),p.$13f()},setScalable:function(O){var h=this,B=h._scalable;h._scalable=O,h.fp("scalable",B,O),h.$13f()},getHtmlType:function(){var Y=this._html;return Y?"string"==typeof Y?"html":Y.getView?"ht":"dom":null},$13f:function(){var N=this,V=N._html,O=N.$10f;if(V){var q=W(),t=!1,n=N.getHtmlType();if(l(q,E,M),l(q,d,A),l(q,a,$),"html"===n?(q.innerHTML=O?O(N.getContext()||{}):V,t=!0):"ht"===n?(Q(q,V.getView()),t=!0):"dom"===n&&(Q(q,V),t=!0),t){var p=2*N._padding;Q(z(),q),N.$5f=q.scrollWidth,N.$6f=q.scrollHeight,N._width=N.$5f+p,N._height=N.$6f+p,N._originWidth=N._width,N._originHeight=N._height,r(z(),q)}}},getUIClass:function(){return x.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);