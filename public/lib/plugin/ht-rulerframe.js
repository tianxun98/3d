!function(p,J){"use strict";var k="position",x="absolute",W="relative",O="px",T="left",B="right",n="top",I="bottom",N="display",E="none",d="block",K=ht.Default,o=K.getInternal(),g=Math.floor,u=Math.ceil,y=Math.PI,S=null,G=p.parseInt,e=function(n){return n.getContext("2d")},w=function(){return document},z=function(J){return w().createElement(J)},Q=function(){return z("canvas")},i=function(y,m,G){y.style.setProperty(m,G,S)},U=function(E,y,o){K.def(ht.widget[E],y,o)},q=function(V,c){V.appendChild(c)},b=function(j,H){j.removeChild(H)},L=K.eventListenerOptionsFalse,X=(K.eventListenerOptionsTrue,function(F,B,l,O){F.addEventListener(B,l,O?L:L)}),_=function($,S,k,O){$.removeEventListener(S,k,O?L:L)};ht.widget.RulerFrame=function(j){var Z=this,L=Z._view=o.createView(null,Z),B=Z.$1k=Q(),m=Z.$2k=Q(),S=Z.$3k=Q(),g=Z.$4k=Q();Z._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},Z._topRulerConfig={visible:!0},Z._rightRulerConfig={visible:!1},Z._bottomRulerConfig={visible:!1},Z._leftRulerConfig={visible:!0},q(L,B),q(L,S),q(L,m),q(L,g),i(L,k,W),i(L,"box-sizing","border-box"),i(L,"-moz-box-sizing","border-box"),i(B,k,x),i(m,k,x),i(S,k,x),i(g,k,x),Z.$14k=function(){Z.$13k=1,Z.iv()},Z.$15k=function(c){if(Z._topRulerConfig.guideVisible||Z._rightRulerConfig.guideVisible||Z._bottomRulerConfig.guideVisible||Z._leftRulerConfig.guideVisible||Z._defaultRulerConfig.guideVisible||(Z._topRulerConfig.guideTipVisible||Z._rightRulerConfig.guideTipVisible||Z._bottomRulerConfig.guideTipVisible||Z._leftRulerConfig.guideTipVisible||Z._defaultRulerConfig.guideTipVisible)&&Z._component){var D=L.getBoundingClientRect();Z.$16k={x:c.clientX-D.left,y:c.clientY-D.top},Z.$5k()}},Z.setComponent(j)},U("RulerFrame",J,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(R){var e=this,m=e._component,A=e.getView();if(A){if(e._component=R,e.fp("component",m,R),m){var l=e.getComponentView(m);b(A,l),_(A,"mousemove",e.$15k),e.removeComponentPropertyChangeListener(m,e.$14k)}if(R){var z=e.getComponentView(R);q(A,z),i(z,k,x),X(A,"mousemove",e.$15k),e.addComponentPropertyChangeListener(R,e.$14k)}}},addComponentPropertyChangeListener:function(z,v){z&&z.mp&&z.mp(v)},removeComponentPropertyChangeListener:function(d,J){d&&d.ump&&d.ump(J)},getComponentHZoom:function(l){return l&&l.getZoom?l.getZoom():1},getComponentVZoom:function($){return $&&$.getZoom?$.getZoom():1},getComponentViewRect:function(X){return X&&X.getViewRect?X.getViewRect():void 0},getComponentView:function(O){return O&&O.getView?O.getView():O},invalidateComponent:function(a){a&&a.iv&&a.iv()},validateComponent:function(e){e&&e.validate&&e.validate()},$7k:function(K,s,F,x,A,u,H,g,w,l,n,r){if(s.visible){var z=this._defaultRulerConfig,R="borderStyle",I="borderColor",W="borderWidth",U="background",p=s[R]||z[R],Q=s[I]||z[I],B=s[W]||z[W],h=s.size!=S?s.size:z.size,m=s[U]||z[U],C=h+B,v=this.$6k(B,p,Q,K,F,A,C,H,g,w,l,n,r);i(K,A,"0px"),u?o.setCanvas(K,x-v,h):o.setCanvas(K,h,x-v),i(K,"background",m),i(K,N,d)}else i(K,N,E),i(this.getComponentView(this._component),A,"0px")},$6k:function(u,J,$,T,A,L,x,M,V,q,l,c,g){var t=0;return i(T,A,u+"px "+J+" "+$),i(this.getComponentView(this._component),L,x+O),M?(i(T,V,q+O),t+=q):i(T,V,"0px"),l?(i(T,c,g+O),t+=g):i(T,c,"0px"),t},validateImpl:function(){var a=this,P=a._component,Y=a.$1k,R=a.$2k,u=a.$3k,l=a.$4k,W=a._view,s=a._defaultRulerConfig,j=a._topRulerConfig,y=a._rightRulerConfig,H=a._bottomRulerConfig,K=a._leftRulerConfig,N=s.size;if(W&&P){var A=j.size!=S?j.size:N,X=y.size!=S?y.size:N,t=H.size!=S?H.size:N,i=K.size!=S?K.size:N;a.$7k(Y,j,"border-bottom",W.offsetWidth,n,!0,K.visible,T,i,y.visible,B,X),a.$7k(R,y,"border-left",W.offsetHeight,B,!1,j.visible,n,A,H.visible,I,t),a.$7k(u,H,"border-top",W.offsetWidth,I,!0,K.visible,T,i,y.visible,B,X),a.$7k(l,K,"border-right",W.offsetHeight,T,!1,j.visible,n,A,H.visible,I,t),a.$13k?delete a.$13k:a.invalidateComponent(P),a.validateComponent(P),a.$5k()}},$5k:function(){function l(p,f,F,R,l,C){if(f.visible){var X=e(p),x=f[I]||D,Q=f[V]!=S?f[V]:Y,z=f[d]||b,v=f[M]||h,L=f.size!=S?f.size:k,ze=f[s]||g,lr=f[K]||m,$i=f[o]||P,qo=f[J]!=S?f[J]:O,hd=f[H]!=S?f[H]:T,Lh=f[W]!=S?f[W]:_,ed=f[B]!=S?f[B]:n,pm=f[w]!=S?f[w]:c,Jo=f[a]!=S?f[a]:t,vc=f[j]||sc,Wr=f[N]||cf;Q&&(x=r[C]=r.$8k(r[C]||x,f[A]||Z,f[$]||u,R?E:i,lr)),F.call(r,X,q,G,y,U,L,R?E:i,x,z,v,l,ze,$i);var fl=r.$16k;(qo||hd)&&fl&&(R?r.$9k(X,fl.x,L,vc,Wr,qo,hd,Lh,ed,pm,Jo):r.$10k(X,fl.y,L,vc,Wr,qo,hd,Lh,ed,pm,Jo,l))}}var r=this,Q=r.$1k,f=r.$2k,R=r.$3k,L=r.$4k,C=r._topRulerConfig,x=r._rightRulerConfig,v=r._bottomRulerConfig,X=r._leftRulerConfig,p=r._defaultRulerConfig,F=r._component,z=r.getComponentViewRect(F),E=r.getComponentHZoom(F),i=r.getComponentVZoom(F),q=z.x*E,y=q+z.width*E,G=z.y*i,U=G+z.height*i,k=r._defaultRulerConfig.size,I="defaultMajorTickSpacing",A="maxPhysicalMajorTickSpacing",$="minPhysicalMajorTickSpacing",V="tickSpacingAdaptable",d="majorTickTextFont",M="majorTickTextColor",s="majorTickColor",o="minorTickColor",J="guideVisible",H="guideTipVisible",W="guideTipBorderColor",B="guideTipTextColor",w="guideTipTextFont",a="guideTipBackground",j="guideColor",N="guideWidth",K="minMajorTickSpacing",D=p[I],Z=p[A],u=p[$],Y=p[V],b=p[d],h=p[M],g=p[s],m=p[K],P=p[o],O=p[J],T=p[H],_=p[W],n=p[B],c=p[w],t=p[a],sc=p[j],cf=p[N];r._view&&F&&(l(Q,C,r.$11k,!0,!1,"_currentTopMajorTickSpacing"),l(f,x,r.$12k,!1,!0,"_currentRightMajorTickSpacing"),l(R,v,r.$11k,!0,!0,"_currentBottomMajorTickSpacing"),l(L,X,r.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(r,C,f,J,E){return f>r*J?r=g(C/J/E)*E:r*J>C&&(r=u(f/J/E)*E),r},getHTipText:function(d){var C=this,k=C._component,B=0,m=C._view.getBoundingClientRect();return k.lp?B=G(k.lp({x:d.x+m.left,y:d.y}).x):B-=G(this.getComponentView(k).style.left)||0,B},$9k:function(u,V,M,E,r,S,s,m,l,Y,W){var k=this,t=k._component;u.save(),o.translateAndScale(u,0,0,1);var z=V-(G(this.getComponentView(t).style.left)||0),L=0;if(V=k.getHTipText(k.$16k),S&&(u.beginPath(),u.fillStyle=E,u.rect(z,L,r,M),u.fill()),s){u.beginPath(),u.textAlign="center",u.textBaseline="middle",u.font=Y;var b=u.measureText(V).width+6;u.fillStyle=W,u.rect(z-b/2,L,b,M),u.fill(),u.strokeStyle=m,u.stroke(),u.beginPath(),u.fillStyle=l,u.fillText(V,z,L+M/2)}u.restore()},getVTipText:function(O){var N=this,E=N._component,S=0,B=N._view.getBoundingClientRect();return E.lp?S=G(E.lp({x:O.x,y:O.y+B.top}).y):S-=G(this.getComponentView(E).style.top)||0,S},formatScaleText:function(q){return Math.round(q)},$10k:function(S,k,O,Q,u,m,e,s,t,v,Z,b){var F=this,a=F._component;S.save(),o.translateAndScale(S,0,0,1);var L=O/2,d=k-(G(this.getComponentView(a).style.top)||0);if(k=F.getVTipText(F.$16k),m&&(S.beginPath(),S.fillStyle=Q,S.rect(L-O/2,d,O,u),S.fill()),e){S.translate(L,d),S.rotate((b?90:-90)*y/180),S.translate(-L,-d),S.beginPath(),S.textAlign="center",S.textBaseline="middle",S.font=v;var c=S.measureText(k).width+6;S.fillStyle=Z,S.rect(L-c/2,d-O/2,c,O),S.fill(),S.strokeStyle=s,S.stroke(),S.fillStyle=t,S.fillText(k,L,d)}S.restore()},$11k:function(V,q,F,Q,z,X,M,m,w,D,J,N,e){V.save(),F=0;var p=q,S=Q,b=(p+S)/2;q=0,Q=S-p,o.translateAndScale(V,0,0,1);var h=0,s=0,Y=G(X/2),A=X-Y,W=J?0:Y,t=m*M,u=t/10;q-=t,Q+=t,V.clearRect(q,0,Q-q,X),V.beginPath(),V.fillStyle=e;var Z=g(b/u)*u-p;for(h=Z;Q>h;h+=u)V.rect(h,F+W,1,A);for(h=Z;h>q;h-=u)V.rect(h,F+W,1,A);for(V.fill(),W=J?0:1,V.beginPath(),V.fillStyle=N,Z=g(b/t)*t-p,h=Z;Q>h;h+=t)V.rect(h,F+W,1,X-1);for(h=Z;h>q;h-=t)V.rect(h,F+W,1,X-1);V.fill();var c=G(/\d+px/.exec(w)[0]),f=(c||10)/2;V.textBaseline="middle",W=J?X-f-2:f+2,V.beginPath(),V.fillStyle=D,V.font=w;var R=g(b/t)*t/M;for(h=Z,s=R;Q>h;h+=t,s+=m){var v=this.getHScaleText?this.getHScaleText(h):s;V.fillText(this.formatScaleText(v),h+2,F+W)}for(h=Z,s=R;h>q;h-=t,s-=m){var v=this.getHScaleText?this.getHScaleText(h):s;V.fillText(this.formatScaleText(v),h+2,F+W)}V.restore()},$12k:function(X,F,D,U,R,e,L,u,E,B,Q,i,J){function H(r,Z,e,$,G,U){G=h.getVScaleText?h.getVScaleText(e):G,G=h.formatScaleText(G),X.translate(r+Z,e),X.rotate(-$),X.translate(-r-Z,-e),X.fillText(G,r+Z+(U?2:1),e),X.translate(r+Z,e),X.rotate($),X.translate(-r-Z,-e)}X.save(),F=0;var Z=D,V=R,q=(Z+V)/2;D=0,R=V-Z,o.translateAndScale(X,0,0,1);var s=0,h=this,M=0,a=G(e/2),S=e-a,l=Q?0:a,_=u*L,A=_/10;D-=_,R+=_,X.clearRect(F,0,e,R-D),X.beginPath(),X.fillStyle=J;var c=g(q/A)*A-Z;for(s=c;R>s;s+=A)X.rect(F+l,s,S,1);for(s=c;s>D;s-=A)X.rect(F+l,s,S,1);for(X.fill(),l=Q?0:1,X.beginPath(),X.fillStyle=i,c=g(q/_)*_-Z,s=c;R>s;s+=_)X.rect(F+l,s,e-1,1);for(s=c;s>D;s-=_)X.rect(F+l,s,e-1,1);X.fill();var W=G(/\d+px/.exec(E)[0]),d=(W||10)/2,t=90*y/180;X.textBaseline="middle",l=Q?e-d:d+2,t=Q?-t:t,X.beginPath(),X.fillStyle=B,X.font=E;var w=g(q/_)*_/L;for(s=c,M=w;R>s;s+=_,M+=u)H(F,l,s,t,M,Q);for(s=c,M=w;s>D;s-=_,M-=u)H(F,l,s,t,M,Q);X.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var X=this,r=X._component,v=X._view;r&&X.removeComponentPropertyChangeListener(r,X.$14k),v&&(_(v,"mousemove",X.$15k),b(v.parentNode,v),X._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);