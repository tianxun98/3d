!function(t,h,y){"use strict";var E="ht",S=t[E],p=S.Default,M=S.graph,C=p.getInternal(),i=C.ui(),U=i.NodeUI.prototype,x=i.ShapeUI.prototype,l=M.GraphView,c=l.prototype,D=i.EdgeUI.prototype,b=S.Node,z=S.Shape,s=S.Edge,k=S.Group,O=p.isTouchable,u=p.preventDefault,K=t.setTimeout,_=p.grow,X=p.isDragging,N=p.getDistance,V=null,B=S.List,A="undefined"!=typeof Float32Array?Float32Array:Array,e=Math,d=e.PI,F="Crossing",a="No Crossing",T=d/2,q=2*d,W=e.atan2,P=e.sqrt,Q=e.pow,R=e.sin,n=e.cos,I=e.min,g=e.max,Y=e.abs,j=e.ceil,f=e.round,v=p.unionPoint,L=p.unionRect,G=p.containsPoint,r=p.clone,Z="rgb(52, 152, 219)",m="red",H={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},w={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var U=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],T=0;T<U.length;T++){var b=U[T];b=0===T%2?b/400*w.width:b/100*w.height,U[T]=b}return w.width>120&&(U[4]=w.width-26,U[6]=w.width-40,U[10]=w.width-40,U[12]=w.width-26,U[18]=33),U}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},J={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:Z,rotation:.61},{type:"circle",rect:[200,120,70,70],background:Z,rotation:.61},{type:"circle",rect:[200,220,70,70],background:Z,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:Z},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:Z}]},$={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:m,rotation:.61}]},o={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:Z},{type:"circle",rect:[0,210,90,90],background:Z},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:Z}]},Xg={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:m},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:m}]},es={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:Z}]},Bf={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:m}]},Gm={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},gc={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Ek=function(K){var d=K.touches[0];return d?d:K.changedTouches[0]},Yf=function(Q,J,C,z){return W(z-J,C-Q)},Do=function(l,c){return{x:l.x*c,y:l.y*c}},hs=function(m,F){m.each(function(O){return m.isSelected(O)?F(O):void 0})},zs=function(e,Q){e.reverseEach(function(_){return e.isSelected(_)?Q(_):void 0})},vk=function(U,b,m){var O,x,I,V,W,i=this,H=b,k=i.gv;if(U instanceof z){I=U.getSegments();var o=k.getDataUI(U);W=o._55O.$15l,I&&I.size()||(I=eq(W)),U.isClosePath()&&I.indexOf(5)<0&&(I=new B(I._as),I.add(5)),O=Sp(U,o,H),x=W[O]}else{var E=k.getDataUI(U);W=Dq(E,U.s("edge.points")),I=U.s("edge.segments"),I&&I.size()||(I=eq(W)),W=W._as,O=Sp(U,E,H),x=W[O]}if(I&&(V=I.get(H)),2===V||1===V||5===V){var c=W[O+1];5===V&&(c=W[0]);var K=Cd(x,m,c);return K}return m},or=function(S,v,g,$){var l=v/2,C=g/2,q=Zi(S,-l,-C,$),x=Zi(S,l,-C,$),G=Zi(S,-l,C,$),D=Zi(S,l,C,$),u=Zi(S,0,-C,$),s=Zi(S,l,0,$),p=Zi(S,0,C,$),B=Zi(S,-l,0,$);return[q,x,G,D,u,s,p,B]},Cd=function(A,G,O){var k={x:G.x-A.x,y:G.y-A.y},n={x:O.x-A.x,y:O.y-A.y},U=P(Q(O.x-A.x,2)+Q(O.y-A.y,2)),f={x:n.x/U,y:n.y/U},I=k.x*f.x+k.y*f.y,Y={x:f.x*I,y:f.y*I};return{x:A.x+Y.x,y:A.y+Y.y}},Zi=function(j,E,y,D){var g=n(D)*E-R(D)*y,w=R(D)*E+n(D)*y;return j?{x:j.x+g,y:j.y+w}:{x:g,y:w}},Zm=function(q,A){return A>2*q?q:A/2},xe=function(P,y,K,L){var j=N(P,y);return K=L?I(K,j):Zm(K,j),j?K/=j:K=0,{x:P.x+(y.x-P.x)*K,y:P.y+(y.y-P.y)*K}},te=function(y,s){var u,S,n=y.gv,O=y._data,T=O._40I,P=O._41I,$=O.s("edge.offset"),I=O.s("edge.source.position"),E=O.s("edge.target.position"),v=O.s("edge.source.offset.x"),F=O.s("edge.source.offset.y"),b=O.s("edge.target.offset.x"),x=O.s("edge.target.offset.y"),D=O.s("edge.source.anchor.x"),K=O.s("edge.source.anchor.y"),U=O.s("edge.target.anchor.x"),k=O.s("edge.target.anchor.y");if(s?(u=C.getEdgeAgentPosition(n,T,I,v,F,D,K),S=C.getEdgeAgentPosition(n,P,E,b,x,U,k)):(u=C.getEdgeAgentPosition(n,T,I,0,0,D,K),S=C.getEdgeAgentPosition(n,P,E,0,0,U,k)),"points"===O.s("edge.type")&&$&&!O.s("edge.center")&&u){var L=O.s("edge.points")||new B,N=L.size(),H=xe(u,N?L.get(0):S,$,N),h=xe(S,N?L.get(N-1):u,$,N);u=H,S=h}return[u,S]},Dq=function(P,t,m){var k=P._78o,i=P._data,y=i.s("edge.type"),T=[k.sourcePoint,k.targetPoint];return"points"===y?m&&(T=te(P)):T=k.center?y?m?te(P):te(P,!0):m?te(P):[k.c1,k.c2]:m?te(P):te(P,!0),t=new B(t?t._as:V),t.add(T[0],0),t.add(T[1]),t},El=function(d){return d=new B(d._as),d.removeAt(0),d.removeAt(d.size()-1),d},eq=function(h){h._as||(h=new B(h));var U=new B;U.add(1);for(var x=1;x<h.size();x++)U.add(2);return U},qk=function(J,_){return{x:(J.x+_.x)/2,y:(J.y+_.y)/2}},zn=function(s,i){return{x:s.x+1*(i.x-s.x)/4,y:s.y+1*(i.y-s.y)/4}},Nr=function(U,s){return{x:U.x+3*(s.x-U.x)/4,y:U.y+3*(s.y-U.y)/4}},Fm=function(q,H,e,t){var Z=H.x+H.width/2,I=H.y+H.height/2,a=P(Z*Z+I*I),S=W(I,Z)+e;return{x:t.x+a*n(S),y:t.y+a*R(S)}},qm=c.validateImpl,_q=c.isRectEditable,Ce=c.isPointEditable,Md=c._42,mi=x._79o,Cc=D._79o,iq=x._48O,Up=x._47O,bo=U._48O,Me=U._80o,xb=x._80o,ss=U.getSelectWidth,ve=U._47O,Kb=D._47O,Ze=c.isEditable,nq=["northwest","north","northeast","east","southeast","south","southwest","west"],Ym=function(K,L,e,$,z,J,j,U,u,a){var d=K.x,w=K.y,i=K.width,Y=K.height,E={x:d+i/2,y:w+Y/2};$=$||0,L=Zi(E,L.x-E.x,L.y-E.y,-$),j&&!U&&(L.x+=u,L.y+=a);var O=.01;if("northwest"===e?(L.x+z>d+i-O&&(L.x=d+i-z-O),L.y+z>w+Y-O&&(L.y=w+Y-z-O),K=v(L,{x:d+i,y:w+Y})):"north"===e?(L.y+z>w+Y-O&&(L.y=w+Y-z-O),K=v({x:d,y:L.y},{x:d+i,y:w+Y})):"northeast"===e?(L.x<d+z+O&&(L.x=d+z+O),L.y+z>w+Y-O&&(L.y=w+Y-z-O),K=v({x:d,y:L.y},{x:L.x,y:w+Y})):"west"===e?(L.x+z>d+i-O&&(L.x=d+i-z-O),K=v({x:L.x,y:w},{x:d+i,y:w+Y})):"east"===e?(L.x<d+z+O&&(L.x=d+z+O),K=v({x:d,y:w},{x:L.x,y:w+Y})):"southwest"===e?(L.x+z>d+i-O&&(L.x=d+i-z-O),L.y<w+z+O&&(L.y=w+z+O),K=v({x:L.x,y:w},{x:d+i,y:L.y})):"south"===e?(L.y<w+z+O&&(L.y=w+z+O),K=v({x:d,y:w},{x:d+i,y:L.y})):"southeast"===e&&(L.x<d+z+O&&(L.x=d+z+O),L.y<w+z+O&&(L.y=w+z+O),K=v({x:d,y:w},L)),"keepRatio"===J&&(!j&&U||j&&!U)&&("northeast"===e||"southeast"===e||"northwest"===e||"southwest"===e)){var D=K.width,B=K.height,_=D/i,r=B/Y,h=I(_,r);K.width=i*h,K.height=Y*h,"northeast"===e?K.y=w+(Y-K.height):"northwest"===e?(K.y=w+(Y-K.height),K.x=d+(i-K.width)):"southwest"===e&&(K.x=d+(i-K.width))}K.x-=E.x,K.y-=E.y;var W=Fm(V,K,$,E);return K.x=W.x-K.width/2,K.y=W.y-K.height/2,K},vr=function(E,u,W,p){var c=E.getRotation(),Q=u,C=Q.x,n=Q.y,P=Q.width,X=Q.height,O={x:C+Q.width/2,y:n+Q.height/2};p=Zi(O,p.x-O.x,p.y-O.y,-c),"northwest"===W?Q=v(p,{x:C+P,y:n+X}):"north"===W?Q=v({x:C,y:p.y},{x:C+P,y:n+X}):"northeast"===W?Q=v({x:C,y:p.y},{x:p.x,y:n+X}):"west"===W?Q=v({x:p.x,y:n},{x:C+P,y:n+X}):"east"===W?Q=v({x:C,y:n},{x:p.x,y:n+X}):"southwest"===W?Q=v({x:p.x,y:n},{x:C+P,y:p.y}):"south"===W?Q=v({x:C,y:n},{x:C+P,y:p.y}):"southeast"===W&&(Q=v({x:C,y:n},p)),E.setRect(Q),Q.x-=O.x,Q.y-=O.y;var R=Fm(E,Q,c,O);E.p(R.x,R.y)},dm=function(G,E,g,L,R,Z,U,s){var e=V;Z?(e=Zi(V,R.x-E.x,R.y-E.y,-g),e.x-=U.x,e.y-=U.y):e=Zi(V,R.x-E.x,R.y-E.y,0);var W={x:E.x+e.x,y:E.y+e.y};s&&(W=s(W.x,W.y)),W.e=G.getPoints().get(L).e,G.setPoint(L,W);var r=G.getWidth(),S=G.getHeight(),a=G.p().x-r/2,B=G.p().y-S/2;a-=E.x,B-=E.y;var j=Fm(G,{x:a,y:B,width:r,height:S},g,E);G.p(j.x,j.y)},Sp=function(y,g,F){var L,W;if(y instanceof z?(L=y.getPoints(),W=y.getSegments()):y instanceof s&&"points"===y.s("edge.type")&&(L=y.s("edge.points"),W=y.s("edge.segments"),L=Dq(g,L)),W&&W.size()||(W=eq(L)),y instanceof z&&y.isClosePath()&&W.indexOf(5)<0&&(W=new B(W._as),W.add(5)),W)for(var U=-1,I=0;I<W.size();I++){if(I===F)return U;var X=W.get(I);1===X?U+=1:2===X?U+=1:3===X?U+=2:4===X&&(U+=3)}},Rl=function(E,i,R){var d,X;if(E instanceof z?(d=E.getPoints(),X=E.getSegments()):E instanceof s&&"points"===E.s("edge.type")&&(d=E.s("edge.points"),X=E.s("edge.segments"),d=Dq(i,d)),X&&X.size()||(X=eq(d)),X)for(var K=-1,r=0;r<X.size();r++){var B=X.get(r);if(1===B?K+=1:2===B?K+=1:3===B?K+=2:4===B&&(K+=3),K===R)return r}},wd=function(t,j){var G=[t[0]-j[0],t[1]-j[1],t[2]-j[2]];return G},ng=function(){var j=new A(16);return j[0]=1,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=1,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=1,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j},gp=function(X,W){var z=X[0],u=X[1],A=X[2];return X[0]=W[0]*z+W[4]*u+W[8]*A+W[12],X[1]=W[1]*z+W[5]*u+W[9]*A+W[13],X[2]=W[2]*z+W[6]*u+W[10]*A+W[14],X},vi=function(V,$){if($){var j=R($),w=n($),u=V[0],X=V[1],b=V[2],d=V[3],S=V[8],I=V[9],H=V[10],Q=V[11];V[0]=u*w-S*j,V[1]=X*w-I*j,V[2]=b*w-H*j,V[3]=d*w-Q*j,V[8]=u*j+S*w,V[9]=X*j+I*w,V[10]=b*j+H*w,V[11]=d*j+Q*w}},go=function(Q,v){for(var M=Q.s("grid.row.count"),l=Q.s("grid.column.count"),B=0;M>B;B++)for(var h=0;l>h;h++){var J=Q.getCellRect(B,h);if(G(J,v))return{rowIndex:B,columnIndex:h,rect:J,grid:Q}}return null},eb=function(L,b,q,l,h,W){var A={},U=q-L,B=l-b,X=e.sqrt(U*U+B*B),n=U/X,G=B/X,Z=(-L+h)*n+(-b+W)*G;return 0>=Z?(A.x=L,A.y=b):Z>=X?(A.x=q,A.y=l):(A.x=L+Z*n,A.y=b+Z*G),U=h-A.x,B=W-A.y,A.z=e.sqrt(U*U+B*B),A},Mq=function(m,q){var S,i,A,L,z,F,Q,r,p=m.getPoints(),D=m.getSegments(),C=m.p(),n=m.getRotation();if(!D||!(D.indexOf(3)>0||D.indexOf(4)>0)){for(r=0;r<=p.size()-1;r++)if(r===p.size()-1?(z=p.get(0),L=p.get(r)):(L=p.get(r),z=p.get(r+1)),L=Zi(C,L.x-C.x,L.y-C.y,n),z=Zi(C,z.x-C.x,z.y-C.y,n),F=eb(L.x,L.y,z.x,z.y,q.x,q.y),Q=F.z,Q<(m.s("shape.border.width")||10)){i=L,A=z,S=r;break}if(S!=V){var R=eb(i.x,i.y,A.x,A.y,q.x,q.y),c=N(i,R);return{attachIndex:S,attachOffset:c}}}},dg=function(O){for(var Y=O._data,r=Y.p(),G=Y.getRotation(),S=Y.getPoints(),J=V,j=[],E=0;E<S.size();E++)J=S.get(E),j.push(Zi(r,J.x-r.x,J.y-r.y,G));O._55O.$15l=j};p.setImage("xeditinteractor_parentIcon",J),p.setImage("xeditinteractor_hostIcon",$),p.setImage("xeditinteractor_edgeIcon",o),p.setImage("xeditinteractor_removeIcon",Xg),p.setImage("xeditinteractor_sourceIcon",es),p.setImage("xeditinteractor_targetIcon",Bf),p.setImage("xeditinteractor_elevationIcon",Gm),p.setImage("xeditinteractor_tallIcon",gc),c._editPointSize=O?24:9,c._edgeHelpers=["parent","remove","source","target"],c._leftTopHelpers=["parent"],c._rightTopHelpers=["host"],c._leftBottomHelpers=["edge"],c._rightBottomHelpers=["remove"],nq=nq.concat(nq).concat(nq),D._79o=function(){var J=this,g=J.gv,E=g.getZoom(),r=g._editInteractor,Z=Cc.call(J);if(!Z)return null;var l=te(J,!0),i=l[0],h=l[1],$={x:Z.x,y:Z.y,width:Z.width,height:Z.height},N=v(i,h);if(r instanceof M.XEditInteractor){$=L($,N);var I=J._55O,V=g.getEditPointSize()/E+2,q=0;I&&I._43O&&(q+=V/2,_($,q))}return $},D._47O=function(t){var k=this,N=k.gv,K=N._editInteractor;K instanceof M.XEditInteractor||Kb.call(k,t)},D.rectIntersects=function(l){var h=this,U=h._data,W=h.gv,H=W.getZoom(),$=h._55O,L=W._editInteractor;if(L instanceof M.XEditInteractor&&W.isEditable(U)&&$&&$._43O&&"points"===U.s("edge.type")){var u=U.s("edge.points"),x=U.s("edge.segments");u=Dq(h,u),x&&x.size()||(x=eq(u)),u=u._as;var C=!1,i=O?5:1,X=l.x+i,P=l.y+i,B={x:X,y:P};if(L._edge===U&&L._hoverSegmentIndex>=0){var w=W._editInteractor._hoverSegmentIndex,I=x.get(w),v=Sp(U,h,w),g=V;if(v!=V&&v>=0){var Q=u[v],f=W.getSegmentHoverWidth()/H;if(2===I||1===I){var J=u[v+1];g=tl(new af(Q.x,Q.y),new af(J.x,J.y),new af(B.x-f,B.y-f),new af(B.x+2*f,B.y+2*f)),g.$62l===F&&(C=!0)}else if(3===I){var R=u[v+1],J=u[v+2];g=Wn(new af(Q.x,Q.y),new af(R.x,R.y),new af(J.x,J.y),new af(B.x-f,B.y-f),new af(B.x+2*f,B.y+2*f)),g.$62l===F&&(C=!0)}else if(4===I){var y=u[v+1],p=u[v+2];J=u[v+3],g=cd(new af(Q.x,Q.y),new af(y.x,y.y),new af(p.x,p.y),new af(J.x,J.y),new af(B.x-f,B.y-f),new af(B.x+2*f,B.y+2*f)),g.$62l===F&&(C=!0)}}}if(C)return!0}return V},x._47O=function(A){var $=this,H=$.gv,S=H._editInteractor;S instanceof M.XEditInteractor||Up.call($,A)},x.rectIntersects=function(U){var u=this,Z=u._data,K=u.gv,x=K.getZoom(),v=u._55O,C=K._editInteractor;if(C instanceof M.XEditInteractor&&K.isEditable(Z)&&v&&v._43O){var r=v.$15l,m=!1,k=O?5:1,Y=U.x+k,$=U.y+k,g={x:Y,y:$};if(r&&r.length===Z.getPoints().size()||(dg(u),r=v.$15l),C._shape===Z&&C._hoverSegmentIndex>=0){var o=Z.getSegments();o&&o.size()||(o=eq(r));var h=K._editInteractor._hoverSegmentIndex,t=o.get(h),D=Sp(Z,u,h),b=V;if(D!=V&&D>=0){var R=r[D],N=K.getSegmentHoverWidth()/x;if(2===t||1===t){var z=r[D+1];b=tl(new af(R.x,R.y),new af(z.x,z.y),new af(g.x-N,g.y-N),new af(g.x+2*N,g.y+2*N)),b.$62l===F&&(m=!0)}else if(3===t){var G=r[D+1],z=r[D+2];b=Wn(new af(R.x,R.y),new af(G.x,G.y),new af(z.x,z.y),new af(g.x-N,g.y-N),new af(g.x+2*N,g.y+2*N)),b.$62l===F&&(m=!0)}else if(4===t){var X=r[D+1],Q=r[D+2];z=r[D+3],b=cd(new af(R.x,R.y),new af(X.x,X.y),new af(Q.x,Q.y),new af(z.x,z.y),new af(g.x-N,g.y-N),new af(g.x+2*N,g.y+2*N)),b.$62l===F&&(m=!0)}}}if(m)return!0}return V},x._48O=function(){var j=this,N=j.gv,C=N._editInteractor;C instanceof M.XEditInteractor?(U._48O.call(j),j._55O._43O&&dg(j)):iq.call(j)},x._79o=function(){var v=this,P=v.gv,Q=P.getZoom(),e=P._editInteractor,l=mi.call(v);if(l){var d={x:l.x,y:l.y,width:l.width,height:l.height};if(e instanceof M.XEditInteractor){var b=v._55O,m=P.getEditPointSize()/Q+2,S=0;b&&b._43O&&(S+=m/2,_(d,S))}return d}},U._47O=function(t){var W=this,E=W.gv,f=E._editInteractor;if(f instanceof M.XEditInteractor);else{var v=W._55O;v&&v._98o&&ve.call(W,t)}},U.getSelectWidth=function(){var w=this,o=w.gv,A=o._editInteractor,J=w._data;return o.isEditable(J)&&A instanceof M.XEditInteractor?0:ss.call(w)},U._80o=function(C){var M=this,b=M.gv._editInteractor;if(Me.call(M,C),b&&b._debug){C.save(),C.beginPath(),C.lineWidth=1,C.strokeStyle="green";var u=M._79o();u&&(C.rect(u.x,u.y,u.width,u.height),C.stroke()),C.restore()}},x._80o=function(x){var L=this,l=L.gv._editInteractor;if(xb.call(L,x),l&&l._debug){x.save(),x.beginPath(),x.lineWidth=1,x.strokeStyle="green";var S=L._79o();x.rect(S.x,S.y,S.width,S.height),x.stroke(),x.restore()}},U._48O=function(){var J=this,b=J.gv,c=J._data,$=b._editInteractor,A=J._55O,e=c.p(),d=c.getRotation();if($ instanceof M.XEditInteractor){if(A._42O){var h=or(e,c.getWidth(),c.getHeight(),d),Q=h[0],I=h[1],n=h[2],Y=h[3],U=h[4],N=h[5],p=h[6],P=h[7];A.$45l=[Q,U,I,N,Y,p,n,P]}}else bo.call(J)},c.getResizeMode=function(){return this.$25l||"normal"},c.setResizeMode=function(F){var N=this.$25l;this.$25l=F,this.fp("resizeMode",N,F)},c.getSnapAngle=function(){return this.$26l||Math.PI/36},c.setSnapAngle=function(S){var m=this.$26l;this.$26l=S,this.fp("snapAngle",m,S)},c.getSnapSpacing=function(){return this.$27l},c.setSnapSpacing=function(i){var x=this.$27l;this.$27l=i,this.fp("snapSpacing",x,i)},c.getPointSnapSpacing=function(){return this._pointSnapSpacing},c.setPointSnapSpacing=function($){var J=this._pointSnapSpacing;this._pointSnapSpacing=$,this.fp("pointSnapSpacing",J,$)},c.setHelperEditableFunc=function(p){var E=this._helperEditableFunc;this._helperEditableFunc=p,this.fp("helperEditableFunc",E,p)},c.getHelperEditableFunc=function(){return this._helperEditableFunc},c.setLeftTopHelpers=function(H){var o=this._leftTopHelpers;this._leftTopHelpers=H,this.fp("leftTopHelpers",o,H)},c.getLeftTopHelpers=function(){return this._leftTopHelpers},c.setLeftTopHelpersAlign=function(p){var c=this._leftTopHelpersAlign;this._leftTopHelpersAlign=p,this.fp("leftTopHelpersAlign",c,p)},c.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},c.setRightTopHelpers=function(e){var h=this._rightTopHelpers;this._rightTopHelpers=e,this.fp("rightTopHelpers",h,e)},c.getRightTopHelpers=function(){return this._rightTopHelpers},c.setRightTopHelpersAlign=function(D){var H=this._rightTopHelpersAlign;this._rightTopHelpersAlign=D,this.fp("rightTopHelpersAlign",H,D)},c.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},c.setLeftBottomHelpers=function(X){var s=this._leftBottomHelpers;this._leftBottomHelpers=X,this.fp("leftBottomHelpers",s,X)},c.getLeftBottomHelpers=function(){return this._leftBottomHelpers},c.setLeftBottomHelpersAlign=function(k){var Z=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=k,this.fp("leftBottomHelpersAlign",Z,k)},c.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},c.setRightBottomHelpers=function(y){var V=this._rightBottomHelpers;this._rightBottomHelpers=y,this.fp("rightBottomHelpers",V,y)},c.getRightBottomHelpers=function(){return this._rightBottomHelpers},c.setRightBottomHelpersAlign=function(V){var b=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=V,this.fp("rightBottomHelpersAlign",b,V)},c.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},c.setEdgeHelpers=function(D){var j=this._edgeHelpers;this._edgeHelpers=D,this.fp("edgeHelpers",j,D)},c.getEdgeHelpers=function(){return this._edgeHelpers},c.isHelperEditable=function(Z,o){return Z instanceof s&&("host"===o||"edge"===o||"elevation"===o||"tall"===o)?!1:Z instanceof b&&("source"===o||"target"===o)?!1:"pointElevation"===o?this._helperEditableFunc?this._helperEditableFunc(Z,o):!1:this._helperEditableFunc?this._helperEditableFunc(Z,o):!0},c.getEditHelperSize=function(){return this._editHelperSize||(O?28:16)},c.setEditHelperSize=function(d){var F=this._editHelperSize;this._editHelperSize=d,this.fp("editHelperSize",F,d)},c.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},c.setEditRectBorderColor=function(A){var u=this.$28l;this.$28l=A,this.fp("editRectBorderColor",u,A)},c.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},c.setNodeBorderColor=function(K){var A=this.$29l;this.$29l=K,this.fp("nodeBorderColor",A,K)},c.getEditRectBorderStyle=function(){return this.$30l||"dashed"},c.setEditRectBorderStyle=function(Z){var Q=this.$30l;this.$30l=Z,this.fp("editRectBorderStyle",Q,Z)},c.getControlPointBackground=function(){return this.$31l||"#ff0"},c.setControlPointBackground=function(h){var c=this.$31l;this.$31l=h,this.fp("controlPointBackground",c,h)},c.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},c.setControlPointBorderColor=function(d){var T=this.$32l;this.$32l=d,this.fp("controlPointBorderColor",T,d)},c.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},c.setJoinPointBackground=function(U){var v=this.$33l;this.$33l=U,this.fp("joinPointBackground",v,U)},c.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},c.setJoinPointBorderColor=function(g){var p=this.$34l;this.$34l=g,this.fp("joinPointBorderColor",p,g)},c.getDirectionLineColor=function(){return this.$35l||"#888"},c.setDirectionLineColor=function(O){var C=this.$35l;this.$35l=O,this.fp("directionLineColor",C,O)},c.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},c.setSegmentHoverColor=function(q){var r=this.$36l;this.$36l=q,this.fp("segmentHoverColor",r,q)},c.getSegmentHoverWidth=function(){return this.$22l||(O?16:8)},c.setSegmentHoverWidth=function(V){var t=this.$22l;this.$22l=V,this.fp("segmentHoverWidth",t,V)},c.getSnapPointBorderColor=function(){return this.$38l||"#f00"},c.setSnapPointBorderColor=function(y){var b=this.$38l;this.$38l=y,this.fp("snapPointBorderColor",b,y)},c.getEditRectPadding=function(){return this.$39l!=V?this.$39l:6},c.setEditRectPadding=function(x){var O=this.$39l;this.$39l=x,this.fp("editRectPading",O,x)},c.isRectEditable=function(K){var $=this,D=$._editInteractor;return D instanceof M.XEditInteractor?$._rectEditableFunc?$._rectEditableFunc(K):!0:_q.call($,K)},c.isPointEditable=function(k){var e=this,K=e._editInteractor;return K instanceof M.XEditInteractor?e._pointEditableFunc?e._pointEditableFunc(k):!0:Ce.call(e,k)},c.validateImpl=function(){var h=this,g=h.$14l,H=h._editInteractor;if(g){var m=h.getWidth(),d=h.getHeight();(m!==g.clientWidth||d!==g.clientHeight)&&(H&&(H._68I=1),C.setCanvas(g,m,d),h._32I=1)}qm.call(this)},c.isEditable=function(S){var R=Ze.call(this,S),H=this._editInteractor;if(H instanceof M.XEditInteractor&&S instanceof s){if(!S.s("2d.editable"))return!1;var p=this.getEditableFunc();R=p?p(S):!0}return R},c._42=function(T,I){var c=this,r=c._editInteractor;Md.call(c,T,I),r instanceof M.XEditInteractor&&r._68I&&r._42()},c.isSnapPoint=function(){return!0};var Tr=function(L){arguments.length>0&&this.$58l(L)},kr=Tr.prototype;kr.$58l=function(_){this.$62l=_,this.points=new Array},kr.$56l=function(D){this.points.push(D)},kr.$57l=function(l){this.points=this.points.concat(l)};var af=function(c,V){arguments.length>0&&this.$58l(c,V)},nk=af.prototype;nk.$58l=function(i,E){this.x=i,this.y=E},nk.add=function(F){return new af(this.x+F.x,this.y+F.y)},nk.addEquals=function(z){return this.x+=z.x,this.y+=z.y,this},nk.$55l=function(Y){return new af(this.x*Y,this.y*Y)},nk.eq=function(P){return this.x==P.x&&this.y==P.y},nk.lt=function(f){return this.x<f.x&&this.y<f.y},nk.lte=function(M){return this.x<=M.x&&this.y<=M.y},nk.gt=function(K){return this.x>K.x&&this.y>K.y},nk.gte=function(P){return this.x>=P.x&&this.y>=P.y},nk.lerp=function(v,t){return new af(this.x+(v.x-this.x)*t,this.y+(v.y-this.y)*t)},nk.distanceFrom=function(s){var H=this.x-s.x,o=this.y-s.y;return P(H*H+o*o)},nk.min=function(p){return new af(I(this.x,p.x),I(this.y,p.y))},nk.max=function(f){return new af(g(this.x,f.x),g(this.y,f.y))},nk.toString=function(){return this.x+","+this.y};var Ug=function(){this.$58l(arguments)},Jl=Ug.prototype;Ug.TO=1e-6,Ug.AC=6,Jl.$58l=function(w){this.co=new Array;for(var $=w.length-1;$>=0;$--)this.co.push(w[$])},Jl.$55l=function(w){for(var Q=new Ug,L=0;L<=this.$50l()+w.$50l();L++)Q.co.push(0);for(var L=0;L<=this.$50l();L++)for(var x=0;x<=w.$50l();x++)Q.co[L+x]+=this.co[L]*w.co[x];return Q},Jl.$59l=function(){for(var i=this.$50l();i>=0&&Y(this.co[i])<=Ug.TO;i--)this.co.pop()},Jl.$50l=function(){return this.co.length-1},Jl.$51l=function(){var r;switch(this.$59l(),this.$50l()){case 0:r=new Array;break;case 1:r=this.$52l();break;case 2:r=this.$53l();break;case 3:r=this.$54l();break;case 4:r=this.$63l();break;default:r=new Array}return r},Jl.$52l=function(){var v=new Array,V=this.co[1];return 0!=V&&v.push(-this.co[0]/V),v},Jl.$53l=function(){var p=new Array;if(2==this.$50l()){var m=this.co[2],Y=this.co[1]/m,$=this.co[0]/m,R=Y*Y-4*$;if(R>0){var l=P(R);p.push(.5*(-Y+l)),p.push(.5*(-Y-l))}else 0==R&&p.push(.5*-Y)}return p},Jl.$63l=function(){var z=new Array;if(4==this.$50l()){var R=this.co[4],u=this.co[3]/R,y=this.co[2]/R,x=this.co[1]/R,v=this.co[0]/R,W=new Ug(1,-y,u*x-4*v,-u*u*v+4*y*v-x*x).$54l(),H=W[0],c=u*u/4-y+H;if(Y(c)<=Ug.TO&&(c=0),c>0){var g=P(c),s=3*u*u/4-g*g-2*y,b=(4*u*y-8*x-u*u*u)/(4*g),V=s+b,n=s-b;if(Y(V)<=Ug.TO&&(V=0),Y(n)<=Ug.TO&&(n=0),V>=0){var m=P(V);z.push(-u/4+(g+m)/2),z.push(-u/4+(g-m)/2)}if(n>=0){var m=P(n);z.push(-u/4+(m-g)/2),z.push(-u/4-(m+g)/2)}}else if(0>c);else{var b=H*H-4*v;if(b>=-Ug.TO){if(0>b&&(b=0),b=2*P(b),s=3*u*u/4-2*y,s+b>=Ug.TO){var O=P(s+b);z.push(-u/4+O/2),z.push(-u/4-O/2)}if(s-b>=Ug.TO){var O=P(s-b);z.push(-u/4+O/2),z.push(-u/4-O/2)}}}}return z},Jl.$54l=function(){var K=new Array;if(3==this.$50l()){var N=this.co[3],f=this.co[2]/N,A=this.co[1]/N,V=this.co[0]/N,L=(3*A-f*f)/3,c=(2*f*f*f-9*A*f+27*V)/27,o=f/3,x=c*c/4+L*L*L/27,F=c/2;if(Y(x)<=Ug.TO&&(x=0),x>0){var G,b,T=P(x);G=-F+T,b=G>=0?Q(G,1/3):-Q(-G,1/3),G=-F-T,G>=0?b+=Q(G,1/3):b-=Q(-G,1/3),K.push(b-o)}else if(0>x){var D=P(-L/3),d=W(P(-x),-F)/3,y=n(d),l=R(d),v=P(3);K.push(2*D*y-o),K.push(-D*(y+v*l)-o),K.push(-D*(y-v*l)-o)}else{var G;G=F>=0?-Q(F,1/3):Q(-F,1/3),K.push(2*G-o),K.push(-G-o)}}return K};var tm=function(K,k){arguments.length>0&&this.$58l(K,k)},Um=tm.prototype;Um.$58l=function(T,c){this.x=T,this.y=c},Um.length=function(){return P(this.x*this.x+this.y*this.y)},Um.$60l=function(G){return this.x*G.x+this.y*G.y};var If=function(d,I,t,e){var T,x=(e.x-t.x)*(d.y-t.y)-(e.y-t.y)*(d.x-t.x),f=(I.x-d.x)*(d.y-t.y)-(I.y-d.y)*(d.x-t.x),Q=(e.y-t.y)*(I.x-d.x)-(e.x-t.x)*(I.y-d.y);if(0!=Q){var H=x/Q,J=f/Q;H>=0&&1>=H&&J>=0&&1>=J?(T=new Tr(F),T.points.push(new af(d.x+H*(I.x-d.x),d.y+H*(I.y-d.y)))):T=new Tr(a)}else T=0==x||0==f?new Tr("C"):new Tr("P");return T},os=function(m,v,w,U,k){var X,H,l,e,Y,D,L,j=U.min(k),$=U.max(k),I=new Tr(a);X=v.$55l(-2),l=m.add(X.add(w)),X=m.$55l(-2),H=v.$55l(2),e=X.add(H),Y=new af(m.x,m.y),L=new tm(U.y-k.y,k.x-U.x),D=U.x*k.y-k.x*U.y;for(var Z=new Ug(L.$60l(l),L.$60l(e),L.$60l(Y)+D).$51l(),d=0;d<Z.length;d++){var n=Z[d];if(n>=0&&1>=n){var R=m.lerp(v,n),P=v.lerp(w,n),G=R.lerp(P,n);U.x==k.x?j.y<=G.y&&G.y<=$.y&&(I.$62l=F,I.$56l(G)):U.y==k.y?j.x<=G.x&&G.x<=$.x&&(I.$62l=F,I.$56l(G)):G.gte(j)&&G.lte($)&&(I.$62l=F,I.$56l(G))}}return I},Wn=function(e,u,s,B,n){var W=B.min(n),A=B.max(n),h=new af(A.x,W.y),H=new af(W.x,A.y),K=os(e,u,s,W,h),d=os(e,u,s,h,A),g=os(e,u,s,A,H),C=os(e,u,s,H,W),V=new Tr(a);return V.$57l(K.points),V.$57l(d.points),V.$57l(g.points),V.$57l(C.points),V.points.length>0&&(V.$62l=F),V},rr=function(c,P,E,n,j,v){var w,K,N,L,Y,t,M,f,p,I,H=j.min(v),h=j.max(v),D=new Tr(a);w=c.$55l(-1),K=P.$55l(3),N=E.$55l(-3),L=w.add(K.add(N.add(n))),Y=new tm(L.x,L.y),w=c.$55l(3),K=P.$55l(-6),N=E.$55l(3),L=w.add(K.add(N)),t=new tm(L.x,L.y),w=c.$55l(-3),K=P.$55l(3),N=w.add(K),M=new tm(N.x,N.y),f=new tm(c.x,c.y),I=new tm(j.y-v.y,v.x-j.x),p=j.x*v.y-v.x*j.y;for(var V=new Ug(I.$60l(Y),I.$60l(t),I.$60l(M),I.$60l(f)+p).$51l(),$=0;$<V.length;$++){var l=V[$];if(l>=0&&1>=l){var A=c.lerp(P,l),z=P.lerp(E,l),G=E.lerp(n,l),m=A.lerp(z,l),T=z.lerp(G,l),R=m.lerp(T,l);j.x==v.x?H.y<=R.y&&R.y<=h.y&&(D.$62l=F,D.$56l(R)):j.y==v.y?H.x<=R.x&&R.x<=h.x&&(D.$62l=F,D.$56l(R)):R.gte(H)&&R.lte(h)&&(D.$62l=F,D.$56l(R))}}return D},cd=function(n,o,j,T,g,b){var U=g.min(b),G=g.max(b),E=new af(G.x,U.y),D=new af(U.x,G.y),P=rr(n,o,j,T,U,E),O=rr(n,o,j,T,E,G),w=rr(n,o,j,T,G,D),r=rr(n,o,j,T,D,U),Q=new Tr(a);return Q.$57l(P.points),Q.$57l(O.points),Q.$57l(w.points),Q.$57l(r.points),Q.points.length>0&&(Q.$62l=F),Q},tl=function(q,S,t,m){var J=t.min(m),s=t.max(m),H=new af(s.x,J.y),X=new af(J.x,s.y),i=If(J,H,q,S),Q=If(H,s,q,S),B=If(s,X,q,S),N=If(X,J,q,S),w=new Tr(a);return w.$57l(i.points),w.$57l(Q.points),w.$57l(B.points),w.$57l(N.points),w.points.length>0&&(w.$62l=F),w},Ad=M.XEditInteractor=function(x){var P=this,f=P._view=document.createElement("canvas");f.className="editCanvas",f.style.position="absolute",Ad.superClass.constructor.call(P,x)};p.def(Ad,M.Interactor,{ms_edit:1,setUp:function(){var m=this,O=m.gv,F=O.getView(),c=m._view;Ad.superClass.setUp.call(m),O.setEditInteractor(m),O.$14l=c,O._79O?F.insertBefore(c,O._79O):F.appendChild(c);var E=m.$49l=m.$11l.bind(m);O.dm().md(E),O.sm().ms(E),O.mp(E)},tearDown:function(){var e=this,C=e.gv,z=C.getView(),U=e.$49l;Ad.superClass.tearDown.call(e),C.setEditInteractor(V),C.$14l=V,z.removeChild(e._view),C.dm().umd(U),C.sm().ums(U),C.ump(U)},clear:function(){var O=this,J=O.gv;delete O._hoverSegmentIndex,delete O._edge,delete O._shape,delete J._editing,delete O.$10l,delete O.$13l,delete O.$9l,delete O._removePointIndex,delete O._lp,O.$12l="",delete O.$40l,delete O.$67l,delete O.$72l,delete O.$73l,delete O.$75l,delete O.$1l,delete O.$3l,delete O.$2l,delete O.$92l,delete O.$93l,delete O.$94l,O.clearDragging()},handle_keydown:function(k){this.$48l!==k.shiftKey&&(this.$48l=k.shiftKey,this.handle_mousemove(k,y,!0))},handle_keyup:function(l){this.$48l!==l.shiftKey&&(this.$48l=l.shiftKey,this.handle_mousemove(l,y,!0))},handle_touchstart:function(Q){this.handle_mousemove(Q),this.handle_mousedown(Q)},handle_mousedown:function(V){u(V);var i=this,$=i.$13l,R=i.gv,q=R.dm(),n=R.sm(),c=R.getZoom(),Q=R.lp(V),U=p.isDoubleClick(V),E=p.isLeftButton(V),F=i.$7l,d=i._shape,Z=i._hoverSegmentIndex,T=i._edge,l=i.$87l,f=i.$88l,B=function(){i._68I||l===i.$87l&&f===i.$88l||i.$43l()};if(7!==i.$67l&&(delete i.$87l,delete i.$88l),E&&(d||T)&&Z>=0&&U&&(d&&n.contains(d)||T&&n.contains(T))){var z=vk.call(i,d||T,Z,Q);return i.addShapePoint(d||T,Z,z),K(function(){i.handle_mousemove(V)},40),void 0}if(E&&(d||T)&&i._removePointIndex>=0&&U)return i.removeShapePoint(),i.$5l=1,K(function(){i.handle_mousemove(V)},40),void 0;if(!E||!R._editing)return B(),void 0;if(d&&$>=0){var h=d.getPoints().get($),g=d.p(),a=Zi(g,h.x-g.x,h.y-g.y,-F+d.getRotation());w=Zi(g,Q.x-g.x,Q.y-g.y,-F),i.$24l={x:w.x-a.x,y:w.y-a.y},i.startDragging(V),q.beginTransaction(),i.fi({kind:"beginEditPoint",event:V,data:d,index:$}),i.$88l=$,i.$87l=d}else if(i.$10l){var X=R.sm().getSelection(),L=i.$6l,Y=i.$1l={},M=i.$3l={},k=i.$16l[H[i.$10l]],t={x:L.x,y:L.y},I={x:L.x+L.width/2,y:L.y+L.height/2};i.$24l={x:Q.x-k.x/c,y:Q.y-k.y/c},i.$2l=r(i.$8l),i.$4l=r(L),X.each(function(H){if(H instanceof b){var n=H.p(),S=H.getWidth(),p=H.getHeight(),m=Zi(I,n.x-I.x,n.y-I.y,-F);Y[H.getId()]={x:n.x-S/2,y:n.y-p/2,width:S,height:p},M[H.getId()]={x:(m.x-t.x)/L.width,y:(m.y-t.y)/L.height}}}),i.startDragging(V),q.beginTransaction(),i.fi({kind:"beginEditRect",event:V,direction:i.$10l})}else if(T&&$>=0){var j=Dq(R.getDataUI(T),T.s("edge.points")),h=j.get($);i.$24l={x:Q.x-h.x,y:Q.y-h.y},i.startDragging(V),q.beginTransaction(),i.fi({kind:"beginEditPoint",event:V,data:T,index:$}),i.$88l=$,i.$87l=T}else if(i.$40l){var L=i.$6l,I={x:L.x+L.width/2,y:L.y+L.height/2},P=r(i.$23l);P.x/=c,P.y/=c;var A=Zi(I,P.x-I.x,P.y-I.y,-F),w=Zi(I,Q.x-I.x,Q.y-I.y,-F);i.$24l={x:w.x-A.x,y:w.y-A.y},i.startDragging(V),q.beginTransaction(),i.fi({kind:"beginEditRotation",event:V,data:i._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(i.$67l)>=0){var G=i.$67l;(7===G||8===G||9===G)&&q.beginTransaction(),i.startDragging(V)}else if(i.$71l&&U&&i.$79l(i.$71l,Q)){var O=n.toSelection();q.beginTransaction(),O.each(function(J){q.remove(J)}),q.endTransaction()}B()},$11l:function(){var O=this,l=O.gv;l._editing&&(O.$13l==V||O._shape==V&&O._edge==V)&&(O.$73l==V||1!==O.$67l&&5!==O.$67l&&6!==O.$67l)||(O.$5l=1),O._68I=1},$46l:function(J){var i=this,R=i.gv,C=R.lp(J),B=[];return zs(R,function(r){var T=R.getDataUI(r);if(T){var V=T._79o();G(V,C)&&B.push(r)}}),B},$47l:function(b){var X=this,o=X.$13l,u=X.gv.dm();X.$10l?(X.fi({kind:"endEditRect",event:b,direction:X.$10l}),u.endTransaction()):X._shape&&o>=0?(X.fi({kind:"endEditPoint",event:b,data:X._shape,index:o}),u.endTransaction()):X._edge&&o>=0?(X.fi({kind:"endEditPoint",event:b,data:X._edge,index:o}),u.endTransaction()):X.$23l&&X.$40l&&(X.fi({kind:"endEditRotation",event:b}),u.endTransaction())},handleWindowTouchEnd:function(S){this.handleWindowMouseUp(S)},handleWindowMouseUp:function(N){var x=this,Q=x.gv,U=Q.dm(),A=x._shape,B=x._edge,P=x.$13l,j=x.$40l,v=x.$9l,t=x.$10l,L=x.$67l;if((A||B)&&P>=0&&v>=0){var G,J;if(A){var z=A.p(),M=A.getRotation();G=A.getPoints(),J=G.get(v),dm(A,z,M,P,J,!1)}else if(G=Dq(Q.getDataUI(B),B.s("edge.points"),!0),J=G.get(v),0===P){var E=G.get(0);B.s("edge.source.offset.x",J.x-E.x),B.s("edge.source.offset.y",J.y-E.y)}else if(P===G.size()-1){var D=G.get(G.size()-1);B.s("edge.target.offset.x",J.x-D.x),B.s("edge.target.offset.y",J.y-D.y)}else"points"===B.s("edge.type")&&(G.set(P,J),B.s("edge.points",El(G)))}x.$47l(N);var T=x.$73l;1===L?(U.beginTransaction(),T?Q.sm().each(function(z){if(z.setHost&&Q.isHelperEditable(z,"host")){z.setHost(T);
var Y=x.$75l,p=x.$74l;Y&&(z.s("attach.row.index",Y.rowIndex),z.s("attach.column.index",Y.columnIndex)),p&&(z.s("attach.index",p.attachIndex),z.s("attach.offset",p.attachOffset),z.s("attach.offset.relative",!1),z.s("attach.offset.opposite",!1))}}):Q.sm().each(function(s){s.setHost&&Q.isHelperEditable(s,"host")&&(s.setHost(V),s.s("attach.row.index",y),s.s("attach.column.index",y),s.s("attach.index",y),s.s("attach.offset",y),s.s("attach.offset.relative",!1),s.s("attach.offset.opposite",!1))}),U.endTransaction()):2===L?(U.beginTransaction(),T?Q.sm().each(function(W){W.setParent&&Q.isHelperEditable(W,"parent")&&W.setParent(T)}):Q.sm().each(function(w){w.setParent&&Q.isHelperEditable(w,"parent")&&w.setParent(V)}),U.endTransaction()):3===L?T&&(U.beginTransaction(),Q.sm().each(function(Z){if(Q.isHelperEditable(Z,"edge")&&Z instanceof b&&T instanceof b){var W=new S.Edge;U.add(W),W.setSource(Z),W.setTarget(T),x.onEdgeCreated&&x.onEdgeCreated(N,W)}}),U.endTransaction()):5===L||6===L?T&&(U.beginTransaction(),Q.sm().each(function(X){X instanceof s&&T instanceof b&&(5===L&&Q.isHelperEditable(X,"source")?X.setSource(T):6===L&&Q.isHelperEditable(X,"source")&&X.setTarget(T))}),U.endTransaction()):(7===L||8===L||9===L)&&U.endTransaction(),(t||j)&&x.$43l(!0),O?(x.clear(),delete x.$64l,x._68I||x.$43l()):(x.handle_mousemove(N,!0),L&&!x._68I&&x.$43l())},handleWindowTouchMove:function(V){this.handleWindowMouseMove(V)},handleWindowMouseMove:function(K){this._78I(K)},handle_mousemove:function(r,P,e){if(!this._pause){if(!e){var v=O?Ek(r):r;this.$61l={clientX:v.clientX,clientY:v.clientY}}if(P===!0||!X()){var E=this,_=E.gv,p=!1,c=V;E.clear(),_.sm().size()>0&&(c=_.lp(e?E.$61l:r),p=E._79I(r,c)),p&&(_._editing=1),E.$12l!==E.$65l&&(E.$65l=E.$12l,E.setCursor(E.$12l)),E.$40l!==E.$64l&&(E.$64l=E.$40l,E._68I||E.$43l()),E._hoverSegmentIndex!==E.$66l&&(E.$66l=E._hoverSegmentIndex,E._68I||E.$43l())}}},_78I:function(w){this.autoScroll(w);var i=this,j=i.gv,C=j.lp(w),B=j.getZoom(),J=i.$13l;if((i._shape||i._edge)&&J>=0){var v,X,Z,R=i._shape,I=i._edge,g=i.$24l,H=j.getPointSnapSpacing(),t=function(p,A){return H==V||isNaN(H)?{x:p,y:A}:{x:f(p/H)*H,y:f(A/H)*H}};if(R){v=R.getPoints();var U=R.p(),m=R.getRotation(),D=0;X=Zi(U,C.x-U.x,C.y-U.y,-m),dm(R,U,m,J,C,!0,g,t),i.fi({kind:"betweenEditPoint",event:w,data:R,index:J})}else if(I){v=Dq(j.getDataUI(I),I.s("edge.points"),!0),C.x-=g.x,C.y-=g.y,X=C;var E,y,e=I.s("edge.offset"),l=v.size(),S=l>2;if(0===J){var u=v.get(0);e&&(u=xe(u,v.get(1),-e,S),C=xe(C,v.get(1),-e,S)),E=C.x-u.x,y=C.y-u.y,Z=t(E,y),I.s("edge.source.offset.x",Z.x),I.s("edge.source.offset.y",Z.y)}else if(J===l-1){var $=v.get(l-1);e&&($=xe($,v.get(l-2),-e,S),C=xe(C,v.get(l-2),-e,S)),E=C.x-$.x,y=C.y-$.y,Z=t(E,y),I.s("edge.target.offset.x",Z.x),I.s("edge.target.offset.y",Z.y)}else"points"===I.s("edge.type")&&(Z=t(C.x,C.y),Z.e=v.get(J).e,v.set(J,Z),I.s("edge.points",El(v)));i.fi({kind:"betweenEditPoint",event:w,data:I,index:J})}if(delete i.$9l,j.isSnapPoint(R)||j.isSnapPoint(I))for(D=0;D<v.size();D++)if(D!==J){var O=v.get(D);if(N(O,X)<j.getEditPointSize()/B){i.$9l=D;break}}}else if(i.$10l){var g=i.$24l;C.x-=g.x,C.y-=g.y;var x=j.sm().getSelection(),L=i.$1l,G=i.$7l,Q=i.$10l,n=i.$4l,F=i.$2l,k=j.getEditRectPadding()/B,h=2*k,r=j.getSnapSpacing(),o=r!=V&&!isNaN(r),_=Ym(F,C,Q,G,2*k,j.getResizeMode(),o,!0),A=i.$6l;if(o){var c=_.width-h,M=_.height-h,a=f(c/r)*r,bl=f(M/r)*r,Jr=a-c,lq=bl-M;("west"===Q||"northwest"===Q||"southwest"===Q)&&(Jr=-Jr),("north"===Q||"northwest"===Q||"northeast"===Q)&&(lq=-lq),_=Ym(F,C,Q,G,2*k,j.getResizeMode(),o,!1,Jr,lq)}i.$8l=_,A.x=_.x+k,A.y=_.y+k,A.width=_.width-h,A.height=_.height-h;var Nn=_.x+_.width/2,rc=_.y+_.height/2,ue=A.x,ne=A.y,_l=A.width/n.width,yk=A.height/n.height;x.each(function(C){if(C instanceof b&&j.isEditable(C)&&j.isRectEditable(C)){var F=L[C.getId()],E=i.$3l[C.getId()],y={x:F.x+F.width/2,y:F.y+F.height/2},O=0,I=0,K=Q,_=180*Y(G-C.getRotation())/d;"northeast"===Q?_>=315||45>_?(O=F.width*_l+F.x,I=F.height*(1-yk)+F.y,K="northeast"):_>=45&&135>_?(O=F.width*(1-yk)+F.x,I=F.height*(1-_l)+F.y,K="northwest"):_>=135&&225>_?(O=F.width*(1-_l)+F.x,I=F.height*yk+F.y,K="southwest"):(O=F.width*yk+F.x,I=F.height*_l+F.y,K="southeast"):"north"===Q?_>=315||45>_?(I=F.height*(1-yk)+F.y,K="north"):_>=45&&135>_?(O=F.width*(1-yk)+F.x,K="west"):_>=135&&225>_?(I=F.height*yk+F.y,K="south"):(O=F.width*yk+F.x,K="east"):"northwest"===Q?_>=315||45>_?(O=F.width*(1-_l)+F.x,I=F.height*(1-yk)+F.y,K="northwest"):_>=45&&135>_?(O=F.width*(1-yk)+F.x,I=F.height*_l+F.y,K="southwest"):_>=135&&225>_?(O=F.width*_l+F.x,I=F.height*yk+F.y,K="southeast"):(O=F.width*yk+F.x,I=F.height*(1-_l)+F.y,K="northeast"):"west"===Q?_>=315||45>_?(O=F.width*(1-_l)+F.x,K="west"):_>=45&&135>_?(I=F.height*_l+F.y,K="south"):_>=135&&225>_?(O=F.width*_l+F.x,K="east"):(I=F.height*(1-_l)+F.y,K="north"):"southwest"===Q?_>=315||45>_?(O=F.width*(1-_l)+F.x,I=F.height*yk+F.y,K="southwest"):_>=45&&135>_?(O=F.width*yk+F.x,I=F.height*_l+F.y,K="southeast"):_>=135&&225>_?(O=F.width*_l+F.x,I=F.height*(1-yk)+F.y,K="northeast"):(O=F.width*(1-yk)+F.x,I=F.height*(1-_l)+F.y,K="northwest"):"east"===Q?_>=315||45>_?(O=F.width*_l+F.x,K="east"):_>=45&&135>_?(I=F.height*(1-_l)+F.y,K="north"):_>=135&&225>_?(O=F.width*(1-_l)+F.x,K="west"):(I=F.height*_l+F.y,K="south"):"south"===Q?_>=315||45>_?(I=F.height*yk+F.y,K="south"):_>=45&&135>_?(O=F.width*yk+F.x,K="east"):_>=135&&225>_?(I=F.height*(1-yk)+F.y,K="north"):(O=F.width*(1-yk)+F.x,K="west"):"southeast"===Q&&(_>=315||45>_?(O=F.width*_l+F.x,I=F.height*yk+F.y,K="southeast"):_>=45&&135>_?(O=F.width*yk+F.x,I=F.height*(1-_l)+F.y,K="northeast"):_>=135&&225>_?(O=F.width*(1-_l)+F.x,I=F.height*(1-yk)+F.y,K="northwest"):(O=F.width*(1-yk)+F.x,I=F.height*_l+F.y,K="southwest"));var q=Zi(y,O-y.x,I-y.y,C.getRotation());vr(C,F,K,{x:q.x,y:q.y});var a=ue+A.width*E.x,t=ne+A.height*E.y,N={x:a,y:t};N=Zi({x:Nn,y:rc},N.x-Nn,N.y-rc,G),C.p(N.x,N.y)}}),i.fi({kind:"betweenEditRect",event:w,direction:Q})}else if(i.$23l&&i.$40l){var Br=i.$8l,nj=Br.width,En=Br.height,U={x:Br.x+nj/2,y:Br.y+En/2},g=i.$24l,Xm=i.$23l,ve=Xm.x/B-U.x,ko=Xm.y/B-U.y,Ce=P(ve*ve+ko*ko),nd=Math.asin(g.x/Ce),Fe=j.sm().getSelection(),aj=T+W(C.y-U.y,C.x-U.x)-nd,Rc=j.getSnapAngle(),aj=f(aj/Rc)*Rc;0>aj&&(aj+=q);var eq=aj-i.$7l,qd=[U.x,0,U.y];Fe.each(function(q){if(j.isEditable(q)&&j.isRotationEditable(q)&&j.isVisible(q)){var M=wd(q.p3(),qd),u=ng();vi(u,-eq),q.setRotation(q.getRotation()+eq),gp(M,u),q.p3(qd[0]+M[0],qd[1]+M[1],qd[2]+M[2])}}),i.$7l=aj,i.fi({kind:"betweenEditRotation",event:w})}else if([1,2,3,5,6].indexOf(i.$67l)>=0)i.$72l=w,i.$78l||(i.$78l=1,K(function(){p.isDragging()&&i.$43l(),delete i.$78l},12));else if(7===i.$67l){if(i.$87l instanceof z){var R=i.$87l,qs=i.$88l,ph=p.clone(R.getPoints().get(qs)),Rr=C.y-ph.y;ph.e||(ph.e=0),i.$92l||(i.$92l=ph.e),ph.e=i.$92l-Rr,R.setPoint(qs,ph)}else if(i.$87l instanceof s){var I=i.$87l,qs=i.$88l,v=Dq(j.getDataUI(I),I.s("edge.points")),ph=v.get(qs),Rr=C.y-ph.y;ph.e||(ph.e=0),i.$92l||(i.$92l=ph.e),ph.e=i.$92l-Rr,v.set(qs,ph),I.s("edge.points",El(v))}}else if(8===i.$67l){var Fe=j.sm().getSelection(),Qj=i.$93l;Qj||(Qj=i.$93l={}),Fe.each(function(O){if(O.p3){var l=O.p3(),k=Qj[O.getId()];k==V&&(k=Qj[O.getId()]=l[1]),O.p3([l[0],k-(C.y-i.$90l.y/B),l[2]])}})}else if(9===i.$67l){var Fe=j.sm().getSelection(),Tf=i.$94l;Tf||(Tf=i.$94l={}),Fe.each(function(y){if(y.s3){var f=y.s3(),H=Tf[y.getId()];H==V&&(H=Tf[y.getId()]=f[1]);var _=H-(C.y-i.$91l.y/B);0>_&&(_=.01),y.s3([f[0],_,f[2]])}})}},$79l:function(u,n){var x=this,k=x.gv,i=k.getZoom(),$=k.getEditHelperSize(),L=u.x/i,N=u.y/i,X=$/i,T=X/2;return G({x:L-T,y:N-T,width:X,height:X},n)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(m,f){for(var W=this,x=W.gv,c=x.getZoom(),a=x.getEditPointSize(),u=a/c,J=u/2,I=W.$46l(m),Q=0;Q<I.length;Q++){var q,y,n=I[Q],R=x.getDataUI(n);if(R&&R._55O){var i=R._55O;if(i._43O&&n instanceof s){if(q=n.s("edge.points"),q=Dq(R,q),y=n.s("edge.segments"),y&&y.size()||(y=eq(q)),W.$42l(n,f,q._as,y,"edge"))return!0;if("points"===n.s("edge.type")&&W.$41l(n,f,q._as,y,"edge"))return}if(i._43O&&n instanceof z&&i.$15l&&i.$15l.length===n.getPoints().size()){if(q=i.$15l,y=n.getSegments(),y&&y.size()||(y=eq(q)),W.$42l(n,f,q,y,"shape"))return!0;if(W.$41l(n,f,q,y,"shape"))return}}}if(W.$16l){var q,A=W.$16l,j=A[3].x-A[7].x,l=A[3].y-A[7].y,X=P(j*j+l*l),$=A[1].x-A[5].x,g=A[1].y-A[5].y,_=P($*$+g*g),U={x:f.x*c,y:f.y*c};if(W._80I(U,0,A[0],"northwest",X,_)||W._80I(U,1,A[1],"north",X,_)||W._80I(U,2,A[2],"northeast",X,_)||W._80I(U,7,A[7],"west",X,_)||W._80I(U,3,A[3],"east",X,_)||W._80I(U,6,A[6],"southwest",X,_)||W._80I(U,5,A[5],"south",X,_)||W._80I(U,4,A[4],"southeast",X,_))return!0}if(W.$23l){var H=W.$23l,M=H.x/c,r=H.y/c;if(G({x:M-J,y:r-J,width:u,height:u},f))return W.$40l=1,W.$12l=W.getHelperCursor("rotation")||"crosshair",!0}return W.$68l&&W.$79l(W.$68l,f)?(W.$67l=1,W.$12l=W.getHelperCursor("host")||"crosshair",!0):W.$69l&&W.$79l(W.$69l,f)?(W.$67l=2,W.$12l=W.getHelperCursor("parent")||"crosshair",!0):W.$70l&&W.$79l(W.$70l,f)?(W.$67l=3,W.$12l=W.getHelperCursor("edge")||"crosshair",!0):W.$71l&&W.$79l(W.$71l,f)?(W.$67l=4,W.$12l=W.getHelperCursor("remove")||"crosshair",!0):W.$82l&&W.$79l(W.$82l,f)?(W.$67l=5,W.$12l=W.getHelperCursor("source")||"crosshair",!0):W.$83l&&W.$79l(W.$83l,f)?(W.$67l=6,W.$12l=W.getHelperCursor("target")||"crosshair",!0):W._pointElevationHelperPoint&&W.$79l(W._pointElevationHelperPoint,f)?(W.$67l=7,W.$12l=W.getHelperCursor("pointElevation")||"crosshair",!0):W.$90l&&W.$79l(W.$90l,f)?(W.$67l=8,W.$12l=W.getHelperCursor("elevation")||"crosshair",!0):W.$91l&&W.$79l(W.$91l,f)?(W.$67l=9,W.$12l=W.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(I,X,R,v,M,P){var Y=this,V=Y.gv,c=V.getEditPointSize(),E=c/2,$=V.sm(),J=V.isDirectionEditable;if(J&&1===$.size()){var F=$.ld();if(J=J.bind(V),F instanceof b){if(!J(F,v))return!1;if("east"===v){if(J(F,"northeast")&&J(F,"southeast")&&2*c>=P)return!1}else if("west"===v){if(J(F,"northwest")&&J(F,"southwest")&&2*c>=P)return!1}else if("north"===v){if(J(F,"northwest")&&J(F,"northeast")&&2*c>=M)return!1}else if("south"===v&&J(F,"southwest")&&J(F,"southeast")&&2*c>=M)return!1}}else{if(2*c>=M&&("north"===v||"south"===v))return!1;if(2*c>=P&&("east"===v||"west"===v))return!1}if(G({x:R.x-E,y:R.y-E,width:c,height:c},I)){if(Y.$10l!==v){var a=180*Y.$7l/d,q="";a>=337.5||22.5>a?q="north":a>=22.5&&67.5>a?q="northeast":a>=67.5&&112.5>a?q="east":a>=112.5&&157.5>a?q="southeast":a>=157.5&&202.5>a?q="south":a>=202.5&&247.5>a?q="southwest":a>=247.5&&292.5>a?q="west":a>=292.5&&337.5>a&&(q="northwest");var A=nq.indexOf(q),q=nq[X-(1-A)+8];switch(q){case"northwest":Y.$12l="nwse-resize";break;case"northeast":Y.$12l="nesw-resize";break;case"southwest":Y.$12l="nesw-resize";break;case"southeast":Y.$12l="nwse-resize";break;case"north":Y.$12l="ns-resize";break;case"east":Y.$12l="ew-resize";break;case"south":Y.$12l="ns-resize";break;case"west":Y.$12l="ew-resize"}Y.$10l=v}return!0}return!1},$42l:function(i,t,C,m,I){var A,V=this,f=V.gv,M=f.getEditPointSize(),u=M/f.getZoom(),X=-1,F={x:t.x,y:t.y,width:0,height:0},L=function(B){"shape"===I?V._shape=i:V._edge=i,V._removePointIndex=B},s=function(A){"shape"===I?V._shape=i:V._edge=i,V.$13l=A,V.$12l="crosshair"};for(_(F,u/2),X=C.length-1,A=m.size()-1;A>=0;A--){var x=m.get(A);if(1===x||2===x)X-=1;else if(3===x){var j=C[X-1];if(G(F,j))return s(X-1),!0;X-=2}else if(4===x){var Q=C[X-1],N=C[X-2];if(G(F,Q))return s(X-1),!0;if(G(F,N))return s(X-2),!0;X-=3}}for(X=C.length-1,A=m.size()-1;A>=0;A--){var x=m.get(A),$=C[X];if(G(F,$))return L(X),s(X),!0;1===x||2===x?X-=1:3===x?X-=2:4===x&&(X-=3)}return!1},$41l:function(q,f,G,C,Z){var s=this,e=s.gv,n=-1,V=0,S={x:f.x,y:f.y,width:0,height:0},W=function(F,D){s._hoverSegmentIndex=D,s._lp=f,"shape"===Z?s._shape=q:s._edge=q};for(_(S,e.getSegmentHoverWidth()/2/e.getZoom()),q instanceof z&&q.isClosePath()&&C.indexOf(5)<0&&(C=new B(C._as),C.add(5));V<C.size();V++){var c=C.get(V);if(1===c){var v=G[n],H=G[n+1];if(v){var o=tl(new af(v.x,v.y),new af(H.x,H.y),new af(S.x,S.y),new af(S.x+S.width,S.y+S.height));if(o.$62l===F&&o.points.length>0)return W(o,V),!0}n+=1}else if(2===c){var v=G[n],H=G[n+1],o=tl(new af(v.x,v.y),new af(H.x,H.y),new af(S.x,S.y),new af(S.x+S.width,S.y+S.height));if(o.$62l===F&&o.points.length>0)return W(o,V),!0;n+=1}else if(3===c){var v=G[n],y=G[n+1],l=G[n+2],o=Wn(new af(v.x,v.y),new af(y.x,y.y),new af(l.x,l.y),new af(S.x,S.y),new af(S.x+S.width,S.y+S.height));if(o.$62l===F)return W(o,V),!0;n+=2}else if(4===c){var v=G[n],$=G[n+1],x=G[n+2],l=G[n+3],o=cd(new af(v.x,v.y),new af($.x,$.y),new af(x.x,x.y),new af(l.x,l.y),new af(S.x,S.y),new af(S.x+S.width,S.y+S.height));if(o.$62l===F)return W(o,V),!0;n+=3}else if(5===c){var v=G[n],H=G[0];if(v){var o=tl(new af(v.x,v.y),new af(H.x,H.y),new af(S.x,S.y),new af(S.x+S.width,S.y+S.height));if(o.$62l===F&&o.points.length>0)return W(o,V),!0}}}return!1},addShapePoint:function(A,d,R){var m=this,o=m.gv,P=o.dm();if(P.beginTransaction(),0===arguments.length&&(A=m._shape||m._edge,d=m._hoverSegmentIndex,R=m._lp),A instanceof z||A instanceof s){var i=Sp(A,o.getDataUI(A),d);if(!isNaN(d)&&R&&!isNaN(i)){var L=R;if(A instanceof z){var M=A.p(),N=A.getRotation(),J=A.toSegments();J&&J.size()||(J=eq(A.getPoints())),A.isClosePath()&&J.indexOf(5)<0&&(J=new B(J._as),J.add(5));var x=J.get(d),g="addPoint",q="removePointAt";if(2===x||1===x){var V={x:L.x,y:L.y};J.add(x,d),V=Zi(M,V.x-M.x,V.y-M.y,-N),A[g](V,i+1)}else if(3===x){var t=A.getPoints(),j=t.get(i),H=t.get(i+2),V={x:L.x,y:L.y};V=Zi(M,V.x-M.x,V.y-M.y,-N);var K=qk(j,V),S=qk(V,H);J.removeAt(d),J.add(3,d),J.add(3,d),A.setPoint(i+1,V),A[g](S,i+2),A[g](K,i+1)}else if(4===x){var t=A.getPoints(),j=t.get(i),H=t.get(i+3),V={x:L.x,y:L.y};V=Zi(M,V.x-M.x,V.y-M.y,-N);var K=zn(j,V),S=Nr(j,V),r=zn(V,H),k=Nr(V,H);J.removeAt(d),J.add(4,d),J.add(4,d),A[q](i+1),A[q](i+1),A[g](V,i+1),A[g](k,i+2),A[g](r,i+2),A[g](S,i+1),A[g](K,i+1)}else if(5===x){var V={x:L.x,y:L.y};J.add(2,d),V=Zi(M,V.x-M.x,V.y-M.y,-N),A[g](V,i+1)}A.isClosePath()&&J.remove(5),A.setSegments(J);var F=A.getWidth(),v=A.getHeight(),X=A.p().x-F/2,G=A.p().y-v/2;X-=M.x,G-=M.y;var y=Fm(A,{x:X,y:G,width:F,height:v},N,M);A.p(y.x,y.y)}else if(A instanceof s){if("points"!==A.s("edge.type"))return P.endTransaction(),void 0;var t=A.s("edge.points");J=A.s("edge.segments"),t=Dq(o.getDataUI(A),t),J&&J.size()||(J=eq(t)),J=new B(J._as.slice(0)),t=new B(t._as.slice(0));var x=J.get(d);if(2===x||1===x){var V={x:L.x,y:L.y};J.add(x,d),t.add(V,i+1)}else if(3===x){var j=t.get(i),H=t.get(i+2),V={x:L.x,y:L.y},K=qk(j,V),S=qk(V,H);J.removeAt(d),J.add(3,d),J.add(3,d),t.set(i+1,V),t.add(S,i+2),t.add(K,i+1)}else if(4===x){var j=t.get(i),H=t.get(i+3),V={x:L.x,y:L.y},K=zn(j,V),S=Nr(j,V),r=zn(V,H),k=Nr(V,H);J.removeAt(d),J.add(4,d),J.add(4,d),t.removeAt(i+1),t.removeAt(i+1),t.add(V,i+1),t.add(k,i+2),t.add(r,i+2),t.add(S,i+1),t.add(K,i+1)}A.s("edge.points",El(t)),A.s("edge.segments",J)}}}P.endTransaction()},removeShapePoint:function(d,E){var c=this,V="removeAt",J=c.gv,I=J.dm();if(I.beginTransaction(),0===arguments.length&&(d=c._shape||c._edge,E=c._removePointIndex),E>=0&&(d instanceof z||d instanceof s)){var D=Rl(d,c.gv.getDataUI(d),E),f=E;if(d instanceof z){var b=d.p(),F=d.toSegments();F&&F.size()||(F=eq(d.getPoints()));var o=F.get(D),S="removePointAt";if(1===o&&0===f)if(d.getPoints().size()>1){var v=F.get(D+1);F[V](D+1),3===v?d[S](f+1):4===v&&(d[S](f+2),d[S](f+1)),d[S](f)}else d.dm().remove(d);else 2===o||1===o?(F[V](D),d[S](f)):3===o?(F[V](D),d[S](f),d[S](f-1)):4===o&&(F[V](D),d[S](f),d[S](f-1),d[S](f-2));d.setSegments(F);var _=d.getWidth(),M=d.getHeight(),O=d.p().x-_/2,K=d.p().y-M/2;O-=b.x,K-=b.y;var q=Fm(d,{x:O,y:K,width:_,height:M},d.getRotation(),b);d.p(q.x,q.y)}else if(d instanceof s){if("points"!==d.s("edge.type"))return I.endTransaction(),void 0;var k=d.s("edge.points");if(F=d.s("edge.segments"),k&&(k=Dq(c.gv.getDataUI(d),k),F&&F.size()||(F=eq(k))),0===E||E===k.size()-1)return I.endTransaction(),void 0;F=new B(F._as.slice(0)),k=new B(k._as.slice(0));var o=F.get(D);2===o||1===o?(F[V](D),k[V](f)):3===o?(F[V](D),k[V](f),k[V](f-1)):4===o&&(F[V](D),k[V](f),k[V](f-1),k[V](f-2)),d.s("edge.segments",F),d.s("edge.points",El(k))}}I.endTransaction()},changeShapeSegment:function(M,p,f){var x=this,b=x.gv,v=b.dm();if(v.beginTransaction(),1!==arguments.length||isNaN(M)||(f=M,M=x._shape||x._edge,p=x._hoverSegmentIndex),M instanceof z||M instanceof s){var q=Sp(M,x.gv.getDataUI(M),p);if(!isNaN(p)&&!isNaN(q))if(M instanceof z){var X=M.p(),o=M.toSegments();o&&o.size()||(o=eq(M.getPoints()));var W=o.get(p),j=M.toPoints();if(1===f||2===f)1===W||2===W?o.set(p,f):3===W?(o.set(p,f),j.removeAt(q+1)):4===W&&(o.set(p,f),j.removeAt(q+1),j.removeAt(q+1));else if(3===f){var u=function(){var x=j.get(q),J=j.get(q+1),L=qk(x,J);o.set(p,3),j.add(L,q+1)};2===W||1===W?u():4===W&&(j.removeAt(q+1),j.removeAt(q+1),u())}else if(4===f){var T=function(){var Y=j.get(q),S=j.get(q+1),n=zn(Y,S),U=Nr(Y,S);o.set(p,4),j.add(n,q+1),j.add(U,q+2)};2===W||1===W?T():3===W&&(j.removeAt(q+1),T())}M.setSegments(o),M.setPoints(j);var D=M.getWidth(),g=M.getHeight(),I=M.p().x-D/2,a=M.p().y-g/2;I-=X.x,a-=X.y;var G=new Fm(M,{x:I,y:a,width:D,height:g},M.getRotation(),X);M.p(G.x,G.y)}else if(M instanceof s){if("points"!==M.s("edge.type"))return v.endTransaction(),void 0;var j=M.s("edge.points");o=M.s("edge.segments"),j&&(j=Dq(x.gv.getDataUI(M),j),o&&o.size()||(o=eq(j))),o=new B(o._as.slice(0)),j=new B(j._as.slice(0));var W=o.get(p);if(1===f||2===f)1===W||2===W?o.set(p,f):3===W?(o.set(p,f),j.removeAt(q+1)):4===W&&(o.set(p,f),j.removeAt(q+1),j.removeAt(q+1));else if(3===f){var u=function(){var Q=j.get(q),z=j.get(q+1),U=qk(Q,z);o.set(p,3),j.add(U,q+1)};2===W||1===W?u():4===W&&(j.removeAt(q+1),j.removeAt(q+1),u())}else if(4===f){var T=function(){var n=j.get(q),y=j.get(q+1),x=zn(n,y),s=Nr(n,y);o.set(p,4),j.add(x,q+1),j.add(s,q+2)};2===W||1===W?T():3===W&&(j.removeAt(q+1),T())}M.s("edge.points",El(j)),M.s("edge.segments",o)}}v.endTransaction()},getDefaultSegments:function(D){var L=this.gv,G=L.getDataUI(D);if(D instanceof s){var p=D.s("edge.points");return p=Dq(G,p),eq(p)}if(D instanceof z){var p=D.getPoints(),d=D.getSegments();return d&&d.size()>0?d:eq(p)}},$43l:function(R){var t=this;R&&(t.$5l=1),t._68I=1,t._42()},_42:function(){var u=this;if(u._68I){delete u._68I;var f=u.gv,y=u.$5l,W=f.getZoom(),I=f.getEditPointSize(),h=I/2,U=new B,Y=u._view,A=u._edge,O=u._shape,n=Y.getContext("2d"),e=f.tx(),g=f.ty(),d=V,R=f.getEditPointBackground(),i=f.getControlPointBackground(),D=f.getControlPointBorderColor(),t=f.getEditPointBorderColor(),K=f.getEditRectBorderColor(),x=f.getDirectionLineColor(),o=f.getSegmentHoverColor(),J=f.getSnapPointBorderColor(),l=f.getJoinPointBackground(),Q=f.getJoinPointBorderColor(),F=f.getSegmentHoverWidth(),X=[5,5],$=f.getEditRectBorderStyle();hs(f,function(p){f.isSelected(p)&&f.isVisible(p)&&U.add(p)}),n.clearRect(0,0,j(Y.width),j(Y.height)),n.save(),C.translateAndScale(n,e,g,1);var T=V,a={x:0,y:0,width:0,height:0},c=0,N=0,E=0,M=0,G=0,H=0,dl=0,Dc=0,qs=0,Kr=0,Yd=[];if(y?(delete u.$6l,delete u.$8l,delete u.$7l,delete u.$16l,delete u.$23l):(T=u.$6l,d=u.$7l),delete u.$68l,delete u.$69l,delete u.$71l,delete u.$70l,delete u.$82l,delete u.$83l,delete u._pointElevationHelperPoint,delete u.$90l,delete u.$91l,delete u.$75l,delete u.$74l,U.each(function(v){var r=f.getDataUI(v);if(r){var h=r._55O;if(f.isEditable(v))h._56O&&v instanceof b&&N++,Yd.push(v),h._42O&&v instanceof b&&c++,f.isHelperEditable(v,"host")&&M++,f.isHelperEditable(v,"parent")&&E++,f.isHelperEditable(v,"remove")&&G++,f.isHelperEditable(v,"edge")&&H++,f.isHelperEditable(v,"source")&&dl++,f.isHelperEditable(v,"target")&&Dc++,f.isHelperEditable(v,"elevation")&&qs++,f.isHelperEditable(v,"tall")&&Kr++;else if(v instanceof k&&v.isExpanded()){var X=!0,I=f.getEditableFunc();I&&(X=I(v)),X&&(f.isHelperEditable(v,"host")&&M++,f.isHelperEditable(v,"parent")&&E++,f.isHelperEditable(v,"remove")&&G++,f.isHelperEditable(v,"edge")&&H++,f.isHelperEditable(v,"source")&&dl++,f.isHelperEditable(v,"target")&&Dc++,f.isHelperEditable(v,"elevation")&&qs++,f.isHelperEditable(v,"tall")&&Kr++,Yd.push(v))}}}),n.beginPath(),n.lineWidth=1,n.strokeStyle=f.getNodeBorderColor(),Yd.forEach(function(K){var h=f.getDataUI(K),p=h._55O;if(y)if(d==V&&(d=K instanceof s?0:K instanceof k&&K.isExpanded()?0:K.getRotation(),u.$7l=d),T==V){var B,Z,D;if(K instanceof k&&K.isExpanded()||K instanceof s){var E=f.getDataUIBounds(K);Z=E.width,D=E.height,B={x:E.x+Z/2,y:E.y+D/2}}else B=K.p(),Z=K.getWidth(),D=K.getHeight();T={x:B.x,y:B.y,width:0,height:0},a.x=B.x-Z/2,a.y=B.y-D/2,a.width=Z,a.height=D,T=L(T,a)}else{var B,Z,D,l,$=T.x+T.width/2,M=T.y+T.height/2,z={x:$,y:M};if(K instanceof k&&K.isExpanded()||K instanceof s){l=0;var E=f.getDataUIBounds(K);Z=E.width,D=E.height,B={x:E.x+Z/2,y:E.y+D/2}}else B=K.p(),Z=K.getWidth(),D=K.getHeight(),l=K.getRotation();var e={x:B.x-Z/2,y:B.y-D/2,width:Z,height:D},R={x:e.x,y:e.y},A={x:e.x+e.width,y:e.y},_={x:e.x,y:e.y+e.height},J={x:e.x+e.width,y:e.y+e.height},R=Zi(B,R.x-B.x,R.y-B.y,l),_=Zi(B,_.x-B.x,_.y-B.y,l),J=Zi(B,J.x-B.x,J.y-B.y,l),A=Zi(B,A.x-B.x,A.y-B.y,l),r=-d,U=Zi(z,R.x-z.x,R.y-z.y,r),o=Zi(z,A.x-z.x,A.y-z.y,r),m=Zi(z,_.x-z.x,_.y-z.y,r),C=Zi(z,J.x-z.x,J.y-z.y,r),t=v([U,o,m,C]);T=L(T,t),T.x-=$,T.y-=M;var H=Fm(V,T,d,z);T.x=H.x-T.width/2,T.y=H.y-T.height/2}if(c>1&&f.isEditable(K)&&f.isRectEditable(K)&&K instanceof b){var q=K.getRect(),G=p.$45l,S=Do(G[0],W),P=Do(G[2],W),j=Do(G[4],W),Q=Do(G[6],W);K.getRotation()?(n.moveTo(S.x,S.y),n.lineTo(P.x,P.y),n.lineTo(j.x,j.y),n.lineTo(Q.x,Q.y),n.lineTo(S.x,S.y)):n.rect(q.x*W,q.y*W,q.width*W,q.height*W)}}),n.stroke(),T){u.$6l=r(T),_(T,f.getEditRectPadding()/W);var Pc={x:T.x+T.width/2,y:T.y+T.height/2},Uh=or(Pc,T.width,T.height,d),qe=Uh[0],zh=Uh[1],Fn=Uh[2],Tm=Uh[3],sh=Uh[4],Rc=Uh[5],Jh=Uh[6],er=Uh[7];if(qe=Do(Uh[0],W),zh=Do(Uh[1],W),Fn=Do(Uh[2],W),Tm=Do(Uh[3],W),sh=Do(Uh[4],W),Rc=Do(Uh[5],W),Jh=Do(Uh[6],W),er=Do(Uh[7],W),u.$8l=T,c>0&&(u.$16l=[qe,sh,zh,Rc,Tm,Jh,Fn,er],n.beginPath(),n.lineWidth=1,n.strokeStyle=K,"dashed"===$&&n.setLineDash&&n.setLineDash(X),n.moveTo(qe.x,qe.y),n.lineTo(zh.x,zh.y),n.lineTo(Tm.x,Tm.y),n.lineTo(Fn.x,Fn.y),n.lineTo(qe.x,qe.y),n.stroke(),"dashed"===$&&n.setLineDash&&n.setLineDash([])),n.beginPath(),n.lineWidth=1,n.fillStyle=R,n.strokeStyle=t,c>0){var Nm=Rc.x-er.x,ge=Rc.y-er.y,ze=P(Nm*Nm+ge*ge),Ul=sh.x-Jh.x,js=sh.y-Jh.y,Vc=P(Ul*Ul+js*js),Wd=2*I;if(f.isDirectionEditable&&1===Yd.length){var Vg=Yd[0],ee=f.getDataUI(Vg),hj=ee._55O,lh=f.isDirectionEditable.bind(f);if(hj._42O){var $l,Ok,qb,lm;lh(Vg,"northwest")&&($l=!0,n.rect(qe.x-h,qe.y-h,I,I)),lh(Vg,"northeast")&&(Ok=!0,n.rect(zh.x-h,zh.y-h,I,I)),lh(Vg,"southwest")&&(qb=!0,n.rect(Fn.x-h,Fn.y-h,I,I)),lh(Vg,"southeast")&&(lm=!0,n.rect(Tm.x-h,Tm.y-h,I,I)),lh(Vg,"north")&&($l&&Ok?ze>Wd&&n.rect(sh.x-h,sh.y-h,I,I):n.rect(sh.x-h,sh.y-h,I,I)),lh(Vg,"south")&&(lm&&qb?ze>Wd&&n.rect(Jh.x-h,Jh.y-h,I,I):n.rect(Jh.x-h,Jh.y-h,I,I)),lh(Vg,"west")&&(qb&&$l?Vc>Wd&&n.rect(er.x-h,er.y-h,I,I):n.rect(er.x-h,er.y-h,I,I)),lh(Vg,"east")&&(lm&&Ok?Vc>Wd&&n.rect(Rc.x-h,Rc.y-h,I,I):n.rect(Rc.x-h,Rc.y-h,I,I))}}else ze>Wd&&(n.rect(sh.x-h,sh.y-h,I,I),n.rect(Jh.x-h,Jh.y-h,I,I)),Vc>Wd&&(n.rect(Rc.x-h,Rc.y-h,I,I),n.rect(er.x-h,er.y-h,I,I)),n.rect(qe.x-h,qe.y-h,I,I),n.rect(zh.x-h,zh.y-h,I,I),n.rect(Fn.x-h,Fn.y-h,I,I),n.rect(Tm.x-h,Tm.y-h,I,I)}if(N>0){var Pf=u.$23l=Zi(sh,0,2*-I,d);n.moveTo(Pf.x+h,Pf.y),n.arc(Pf.x,Pf.y,h,0,q,!1)}n.fill(),n.stroke(),u.$40l&&u.$44l(n,T,d);var Io,Jq,Hh=f.getLeftTopHelpers(),Zr=f.getRightTopHelpers(),Af=f.getLeftBottomHelpers(),Fo=f.getRightBottomHelpers(),nm=f.getEdgeHelpers(),si=f.getEditHelperSize(),Pb=si/2,Np=function($,e,V,J){"leftTop"===e?(Io=T.x*W-si-h-("h"===J?V*(si+h):0)-1,Jq=T.y*W-si-h-("v"===J?V*(si+h):0)-1):"rightTop"===e?(Io=(T.x+T.width)*W+h+("h"===J?V*(si+h):0)+1,Jq=T.y*W-si-h-("v"===J?V*(si+h):0)-1):"leftBottom"===e?(Io=T.x*W-si-h-("h"===J?V*(si+h):0)-1,Jq=(T.y+T.height)*W+h+("v"===J?V*(si+h):0)+1):"rightBottom"===e&&(Io=(T.x+T.width)*W+h+("h"===J?V*(si+h):0)+1,Jq=(T.y+T.height)*W+h+("v"===J?V*(si+h):0)+1);var F=Io+Pb,k=Jq+Pb,L=(T.x+T.width/2)*W,y=(T.y+T.height/2)*W,B=Zi({x:L,y:y},F-L,k-y,d);if("host"===$){if(M>0)return u.$77l(n,d,B),!0}else if("edge"===$){if(H>0)return u.$80l(n,d,B),!0}else if("remove"===$){if(G>0)return Yd&&1===Yd.length&&Yd[0]instanceof s?u.$81l(n,d,{x:L+si/2+5,y:y}):u.$81l(n,d,B),!0}else if("parent"===$){if(E>0)return Yd&&1===Yd.length&&Yd[0]instanceof s?u.$76l(n,d,{x:L-si/2-5,y:y}):u.$76l(n,d,B),!0}else if("elevation"===$){if(qs>0)return u.$85l(n,d,B),!0}else if("tall"===$){if(Kr>0)return u.$86l(n,d,B),!0}else if("source"===$||"target"===$){var b=Yd[0],Q=f.getDataUI(b),A=te(Q,!0),X=A[0],l=A[1];if(dl&&"source"===$)return u.$84l(n,T,X,!0,b.isLooped(),e,V,J),!0;if(Dc&&"target"===$)return u.$84l(n,T,l,!1,b.isLooped(),e,V,J),!0}};if(Hh&&Hh.length>0){var zr=0;Hh.forEach(function(S){Np(S,"leftTop",zr,f.getLeftTopHelpersAlign()||"h")&&zr++})}if(Zr&&Zr.length>0){var zr=0;Zr.forEach(function(n){Np(n,"rightTop",zr,f.getRightTopHelpersAlign()||"h")&&zr++})}if(Af&&Af.length>0){var zr=0;Af.forEach(function(w){Np(w,"leftBottom",zr,f.getLeftBottomHelpersAlign()||"h")&&zr++})}if(Fo&&Fo.length>0){var zr=0;Fo.forEach(function($){Np($,"rightBottom",zr,f.getRightBottomHelpersAlign()||"h")&&zr++})}if(nm&&nm.length>0&&((dl||Dc)&&Yd&&1===Yd.length&&Yd[0]instanceof s?!0:!1)){var zr=0;nm.forEach(function(x){Np(x,"edge",zr,"h")&&zr++})}if(u.$72l){var sd,pj=u.$67l,Xf=u.$68l,fs=u.$69l,Wo=(u.$71l,u.$70l),Xr=u.$82l,Td=u.$83l;if(1===pj?sd=Xf:2===pj?sd=fs:3===pj?sd=Wo:5===pj?sd=Xr:6===pj&&(sd=Td),sd){var Bd=f.lp(u.$72l),cj=f.getDataAt(u.$72l);if(cj&&cj instanceof b){var Mb,xj,zi;if(u.$73l=cj,1===pj)if(cj instanceof S.Grid)Mb=u.$75l=go(cj,Bd);else if(cj instanceof S.Shape){zi=u.$74l=Mq(cj,Bd);var gh=cj.getPoints();if(zi){var Hg=zi.attachIndex,as=Sp(cj,f.getDataUI(cj),Hg)+1,Pd=as+1>=gh.size()?0:as+1,gg=gh.get(as),Zl=gh.get(Pd),Eq=cj.p(),Nk=cj.getRotation();gg=Zi(Eq,gg.x-Eq.x,gg.y-Eq.y,Nk),Zl=Zi(Eq,Zl.x-Eq.x,Zl.y-Eq.y,Nk),n.beginPath(),n.strokeStyle=o,n.lineWidth=F,n.moveTo(gg.x*W,gg.y*W),n.lineTo(Zl.x*W,Zl.y*W),n.stroke()}}Mb?xj=Mb.rect:(xj=p.clone(f.getDataUIBounds(cj)),p.grow(xj,2)),n.beginPath(),n.rect(xj.x*W,xj.y*W,xj.width*W,xj.height*W),n.strokeStyle=1===pj||4===pj||6===pj?m:Z,n.lineWidth=2,n.setLineDash&&n.setLineDash([8,8]),n.stroke()}else delete u.$73l;Bd.x=Bd.x*W,Bd.y=Bd.y*W;var Op=Yf(sd.x,sd.y,Bd.x,Bd.y),me=Zi(sd,Bd.x-sd.x,Bd.y-sd.y,-Op),Ve=me.x-sd.x;n.save(),n.translate(sd.x,sd.y),n.rotate(Op),w.width=Ve,w.height=40;var Jc=Z;(1===pj||4===pj||6===pj)&&(Jc=m),w.comps[0].gradientColor=Jc,p.drawImage(n,w,0,-20,Ve,40),n.restore()}}}if(U.each(function(C){var $=f.getDataUI(C);if($){var v,r,m=$._55O,Y=$._78o;if(m&&m._43O&&C instanceof z?(v=m.$15l,r=C.getSegments(),r&&r.size()||(r=eq(v)),C.isClosePath()&&r.indexOf(5)<0&&(r=new B(r._as),r.add(5))):m&&Y&&m._43O&&(v=C.s("edge.points"),r=C.s("edge.segments"),v=Dq($,v),r&&r.size()||(r=eq(v)),v&&(v=v._as)),v&&r){var b=0,T=r.size(),H=u._hoverSegmentIndex;v=v.slice(0);for(var U=0;U<v.length;U++)v[U]=Do(v[U],W);n.beginPath(),n.strokeStyle=x,n.lineWidth=1,b=0;for(var U=0;T>U;U++){var K=r.get(U);if(1===K||2===K)b++;else if(3===K){var X=v[b-1],S=v[b],E=v[b+1];n.moveTo(X.x,X.y),n.lineTo(S.x,S.y),n.lineTo(E.x,E.y),b+=2}else if(4===K){var X=v[b-1],c=v[b],I=v[b+1],E=v[b+2];n.moveTo(X.x,X.y),n.lineTo(c.x,c.y),n.moveTo(I.x,I.y),n.lineTo(E.x,E.y),b+=3}}if(n.stroke(),O===C||A===C&&"points"===A.s("edge.type")){n.beginPath(),b=0,n.strokeStyle=o,n.lineWidth=F;for(var U=0;T>U;U++){var K=r.get(U);if(1===K||2===K){if(H===U){var X=v[b-1],E=v[b];n.moveTo(X.x,X.y),n.lineTo(E.x,E.y);break}b++}else if(3===K){if(H===U){var X=v[b-1],S=v[b],E=v[b+1];n.moveTo(X.x,X.y),n.quadraticCurveTo(S.x,S.y,E.x,E.y);break}b+=2}else if(4===K){if(H===U){var X=v[b-1],c=v[b],I=v[b+1],E=v[b+2];n.moveTo(X.x,X.y),n.bezierCurveTo(c.x,c.y,I.x,I.y,E.x,E.y);break}b+=3}else if(5===K&&H===U){var X=v[b-1],E=v[0];n.moveTo(X.x,X.y),n.lineTo(E.x,E.y);break}}n.stroke()}n.beginPath(),b=0,n.strokeStyle=Q,n.lineWidth=1,n.fillStyle=l;for(var U=0;T>U;U++){var K=r.get(U);if(1===K||2===K){var E=v[b];n.moveTo(E.x+h,E.y),n.arc(E.x,E.y,h,0,q,!0),b++}else if(3===K){var E=v[b+1];n.moveTo(E.x+h,E.y),n.arc(E.x,E.y,h,0,q,!0),b+=2}else if(4===K){var E=v[b+2];n.moveTo(E.x+h,E.y),n.arc(E.x,E.y,h,0,q,!0),b+=3}}n.fill(),n.stroke(),n.beginPath(),b=0,n.strokeStyle=D,n.lineWidth=1,n.fillStyle=i;for(var U=0;T>U;U++){var K=r.get(U);if(1===K||2===K)b++;else if(3===K){var S=v[b];n.moveTo(S.x+h,S.y),n.arc(S.x,S.y,h,0,q,!0),b+=2}else if(4===K){var c=v[b],I=v[b+1];n.moveTo(c.x+h,c.y),n.arc(c.x,c.y,h,0,q,!0),n.moveTo(I.x+h,I.y),n.arc(I.x,I.y,h,0,q,!0),b+=3}}if(n.fill(),n.stroke(),n.beginPath(),b=0,n.strokeStyle=J,n.lineWidth=2,(O===C||A===C)&&u.$9l!=V){var E=v[u.$9l];n.moveTo(E.x+h,E.y),n.arc(E.x,E.y,h,0,q,!0),n.stroke()}}}}),u.$87l&&f.sm().contains(u.$87l)){var co,Qq=u.$87l,nb=u.$88l,si=f.getEditHelperSize(),Pb=si/2;if(f.isHelperEditable(Qq,"pointElevation"))if(Qq instanceof z){var vo=Qq.getPosition();co=p.clone(Qq.getPoints().get(nb)),co=Zi({x:vo.x,y:vo.y},co.x-vo.x,co.y-vo.y,Qq.getRotation()),co.x*=W,co.y*=W,n.translate(co.x,co.y),p.drawImage(n,p.getImage("xeditinteractor_elevationIcon"),Pb,-Pb,si,si),n.translate(-co.x,-co.y),u._pointElevationHelperPoint={x:co.x+si,y:co.y}}else if(Qq instanceof s){var no=Dq(f.getDataUI(Qq),Qq.s("edge.points")),co=p.clone(no.get(nb));co.x*=W,co.y*=W,n.translate(co.x,co.y),p.drawImage(n,p.getImage("xeditinteractor_elevationIcon"),Pb,-Pb,si,si),n.translate(-co.x,-co.y),u._pointElevationHelperPoint={x:co.x+si,y:co.y}}}n.restore(),u.$5l=0}},$89l:function(x,O,g,G){x.save();var K=this,i=K.gv,y=i.getEditHelperSize(),I=y/2;x.beginPath(),x.translate(g.x,g.y),x.rotate(O),p.drawImage(x,G,-I,-I,y,y),x.restore()},$85l:function(x,l,$){var e=this;e.$90l=$,e.$89l(x,l,$,p.getImage("xeditinteractor_elevationIcon"))},$86l:function(V,O,W){var q=this;q.$91l=W,q.$89l(V,O,W,p.getImage("xeditinteractor_tallIcon"))},$77l:function(m,U,N){var I=this;I.$68l=N,I.$89l(m,U,N,p.getImage("xeditinteractor_hostIcon"))},$80l:function(_,S,V){var Q=this;Q.$70l=V,Q.$89l(_,S,V,p.getImage("xeditinteractor_edgeIcon"))},$81l:function(J,r,G){var Q=this;Q.$71l=G,Q.$89l(J,r,G,p.getImage("xeditinteractor_removeIcon"))},$76l:function(o,t,E){var u=this;u.$69l=E,u.$89l(o,t,E,p.getImage("xeditinteractor_parentIcon"))},$84l:function(i,F,O,m,h){var x,B=this,z=B.gv,P=z.getZoom(),A=z.getEditHelperSize(),G=A/2;O.x*=P,O.y*=P,h&&(m?O.x-=G+5:O.x+=G+5),O.y-=A-2,m?(B.$82l=O,x=p.getImage("xeditinteractor_sourceIcon")):(B.$83l=O,x=p.getImage("xeditinteractor_targetIcon")),i.beginPath(),i.translate(O.x,O.y),p.drawImage(i,x,-G,-G,A,A),i.translate(-O.x,-O.y)},$44l:function(t,Z,e){t.save();var c=this.gv.getZoom(),o=P(Q(Z.width,2)+Q(Z.height,2))/2*c+10,y=o,u=y+8,q=y+18,w=e,O=Z.x+Z.width/2,s=Z.y+Z.height/2;t.translate(O*c,s*c),t.beginPath(),t.strokeStyle="rgb(150, 150, 150)";for(var l=0,h=0,D=0,A=0,_=0,X=0;360>X;X++)l=X*d/180,0===X%5&&(h=n(l)*y,D=R(l)*y,A=n(l)*u,_=R(l)*u,t.moveTo(h,D),t.lineTo(A,_)),0===X%45&&(h=n(l)*y,D=R(l)*y,A=n(l)*q,_=R(l)*q,t.moveTo(h,D),t.lineTo(A,_));t.stroke(),t.beginPath(),t.rotate(-T),t.beginPath(),t.fillStyle="rgba(255, 0, 0, 0.1)",t.strokeStyle="rgb(157, 157, 157)",t.moveTo(0,0),t.arc(0,0,q,0,e,!1),t.fill(),t.beginPath(),t.moveTo(0+q,0),t.arc(0,0,q,0,e,!1),t.stroke(),t.rotate(T),t.font="bold 12px Verdana, Arial";var M=20*R(w),b=20*n(w),B=f(180*w/d)+"°";t.textAlign="center",t.textBaseline="middle",t.beginPath();var z=t.measureText("365.°").width;t.fillStyle="white",t.rect(M-z/2,-b-10,z,20),t.fill(),t.beginPath(),t.fillStyle="rgb(79,79,79)",t.fillText(B,M,-b),t.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);